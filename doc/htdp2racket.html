<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>From HtDP to Racket</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">From Ht<span class="mywbr"> &nbsp;</span>DP to Racket</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._intro%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._v0%29" class="tocviewlink" data-pltdoc="x">ISBN extraction in ISL+</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._v1%29" class="tocviewlink" data-pltdoc="x">Preparing for Racket</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._v2%29" class="tocviewlink" data-pltdoc="x">Getting into Racket</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._v3%29" class="tocviewlink" data-pltdoc="x">Full pattern matching and <span class="RktSym"><span class="RktStxLink">for</span></span> loops</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#%28part._v4%29" class="tocviewlink" data-pltdoc="x">Regular expressions</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="#%28part._v5%29" class="tocviewlink" data-pltdoc="x">Modules and Contracts</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="#%28part._v6%29" class="tocviewlink" data-pltdoc="x">More on modules and <span class="RktModLink"><span class="RktSym">rackunit</span></span></a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="#%28part._v7%29" class="tocviewlink" data-pltdoc="x">Syntactic abstraction and function definitions</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="#%28part._conclusion%29" class="tocviewlink" data-pltdoc="x">Conclusion</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.From_.Ht.D.P_to_.Racket%29" class="tocsubseclink" data-pltdoc="x">From Ht<span class="mywbr"> &nbsp;</span>DP to Racket</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._intro%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._v0%29" class="tocsubseclink" data-pltdoc="x">ISBN extraction in ISL+</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._v1%29" class="tocsubseclink" data-pltdoc="x">Preparing for Racket</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.The_universe_of_languages%29" class="tocsubseclink" data-pltdoc="x">The universe of languages</a></td></tr><tr><td><span class="tocsublinknumber">3.1.1<tt>&nbsp;</tt></span><a href="#%28part._.Beginning_pattern_matching%29" class="tocsubseclink" data-pltdoc="x">Beginning pattern matching</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._.Beginning_for_loops%29" class="tocsubseclink" data-pltdoc="x">Beginning <span class="RktSym">for</span> loops</a></td></tr><tr><td><span class="tocsublinknumber">3.2.1<tt>&nbsp;</tt></span><a href="#%28part._for_list_and_for__list%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">for/<span class="mywbr"> &nbsp;</span>list</span></span> and <span class="RktSym"><span class="RktStxLink">for*/<span class="mywbr"> &nbsp;</span>list</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.2.2<tt>&nbsp;</tt></span><a href="#%28part._for_and%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">for/<span class="mywbr"> &nbsp;</span>and</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.2.3<tt>&nbsp;</tt></span><a href="#%28part._for_sum%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">for/<span class="mywbr"> &nbsp;</span>sum</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.2.4<tt>&nbsp;</tt></span><a href="#%28part._.More_on_for_or_and_for_and%29" class="tocsubseclink" data-pltdoc="x">More on <span class="RktSym"><span class="RktStxLink">for/<span class="mywbr"> &nbsp;</span>or</span></span> and <span class="RktSym"><span class="RktStxLink">for/<span class="mywbr"> &nbsp;</span>and</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._v2%29" class="tocsubseclink" data-pltdoc="x">Getting into Racket</a></td></tr><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._.The_.Racket_language%29" class="tocsubseclink" data-pltdoc="x">The Racket language</a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._.Requiring_what_you_need%29" class="tocsubseclink" data-pltdoc="x">Requiring what you need</a></td></tr><tr><td><span class="tocsublinknumber">4.3<tt>&nbsp;</tt></span><a href="#%28part._.Replacing_teaching_functions%29" class="tocsubseclink" data-pltdoc="x">Replacing teaching functions</a></td></tr><tr><td><span class="tocsublinknumber">4.4<tt>&nbsp;</tt></span><a href="#%28part._.Replacing_your_own_functions%29" class="tocsubseclink" data-pltdoc="x">Replacing your own functions</a></td></tr><tr><td><span class="tocsublinknumber">4.5<tt>&nbsp;</tt></span><a href="#%28part._.Local_definitions%29" class="tocsubseclink" data-pltdoc="x">Local definitions</a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._v3%29" class="tocsubseclink" data-pltdoc="x">Full pattern matching and <span class="RktSym"><span class="RktStxLink">for</span></span> loops</a></td></tr><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._.More_on_pattern_matching%29" class="tocsubseclink" data-pltdoc="x">More on pattern matching</a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._.More_on_for%29" class="tocsubseclink" data-pltdoc="x">More on <span class="RktSym"><span class="RktStxLink">for</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.2.1<tt>&nbsp;</tt></span><a href="#%28part._for_fold%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">for/<span class="mywbr"> &nbsp;</span>fold</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.2.2<tt>&nbsp;</tt></span><a href="#%28part._for_guards%29" class="tocsubseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">for</span></span> guards</a></td></tr><tr><td><span class="tocsublinknumber">5.3<tt>&nbsp;</tt></span><a href="#%28part._.Sequences%29" class="tocsubseclink" data-pltdoc="x">Sequences</a></td></tr><tr><td><span class="tocsublinknumber">5.4<tt>&nbsp;</tt></span><a href="#%28part._.A_couple_of_final_tweaks%29" class="tocsubseclink" data-pltdoc="x">A couple of final tweaks</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._v4%29" class="tocsubseclink" data-pltdoc="x">Regular expressions</a></td></tr><tr><td><span class="tocsublinknumber">6.1<tt>&nbsp;</tt></span><a href="#%28part._.Data_type_definitions_with_regexes%29" class="tocsubseclink" data-pltdoc="x">Data type definitions with <span style="font-style: italic">regexes</span></a></td></tr><tr><td><span class="tocsublinknumber">6.2<tt>&nbsp;</tt></span><a href="#%28part._regexes_in_predicates%29" class="tocsubseclink" data-pltdoc="x"><span style="font-style: italic">regexes</span> in predicates</a></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="#%28part._v5%29" class="tocsubseclink" data-pltdoc="x">Modules and Contracts</a></td></tr><tr><td><span class="tocsublinknumber">7.1<tt>&nbsp;</tt></span><a href="#%28part._.Modules%29" class="tocsubseclink" data-pltdoc="x">Modules</a></td></tr><tr><td><span class="tocsublinknumber">7.1.1<tt>&nbsp;</tt></span><a href="#%28part._.The_module_form%29" class="tocsubseclink" data-pltdoc="x">The <span class="RktSym"><span class="RktStxLink">module</span></span> form</a></td></tr><tr><td><span class="tocsublinknumber">7.1.2<tt>&nbsp;</tt></span><a href="#%28part._.Module_sections%29" class="tocsubseclink" data-pltdoc="x">Module sections</a></td></tr><tr><td><span class="tocsublinknumber">7.1.3<tt>&nbsp;</tt></span><a href="#%28part._.Requiring_our_own_modules%29" class="tocsubseclink" data-pltdoc="x">Requiring our own modules</a></td></tr><tr><td><span class="tocsublinknumber">7.1.4<tt>&nbsp;</tt></span><a href="#%28part._.What_to_export_%29" class="tocsubseclink" data-pltdoc="x">What to export?</a></td></tr><tr><td><span class="tocsublinknumber">7.1.5<tt>&nbsp;</tt></span><a href="#%28part._.Resource-awareness_requires%29" class="tocsubseclink" data-pltdoc="x">Resource-<wbr></wbr>awareness <span class="RktSym"><span class="RktStxLink">require</span></span>s</a></td></tr><tr><td><span class="tocsublinknumber">7.2<tt>&nbsp;</tt></span><a href="#%28part._.Contracts%29" class="tocsubseclink" data-pltdoc="x">Contracts</a></td></tr><tr><td><span class="tocsublinknumber">7.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Data_types_and_contracts%29" class="tocsubseclink" data-pltdoc="x">Data types and contracts</a></td></tr><tr><td><span class="tocsublinknumber">7.2.2<tt>&nbsp;</tt></span><a href="#%28part._.Function_contracts%29" class="tocsubseclink" data-pltdoc="x">Function contracts</a></td></tr><tr><td><span class="tocsublinknumber">7.2.3<tt>&nbsp;</tt></span><a href="#%28part._.From_signatures_to_contracts%29" class="tocsubseclink" data-pltdoc="x">From signatures to contracts</a></td></tr><tr><td><span class="tocsublinknumber">7.2.4<tt>&nbsp;</tt></span><a href="#%28part._.Aside__what_about_data_type_definitions_%29" class="tocsubseclink" data-pltdoc="x">Aside:<span class="mywbr"> &nbsp;</span> what about data type definitions?</a></td></tr><tr><td><span class="tocsublinknumber">8<tt>&nbsp;</tt></span><a href="#%28part._v6%29" class="tocsubseclink" data-pltdoc="x">More on modules and <span class="RktModLink"><span class="RktSym">rackunit</span></span></a></td></tr><tr><td><span class="tocsublinknumber">8.1<tt>&nbsp;</tt></span><a href="#%28part._.From_submodules_to_modules%29" class="tocsubseclink" data-pltdoc="x">From submodules to modules</a></td></tr><tr><td><span class="tocsublinknumber">8.2<tt>&nbsp;</tt></span><a href="#%28part._.Rackunit_and_testing_submodules%29" class="tocsubseclink" data-pltdoc="x">Rackunit and testing submodules</a></td></tr><tr><td><span class="tocsublinknumber">8.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Unit_testing_with_rackunit%29" class="tocsubseclink" data-pltdoc="x">Unit testing with rackunit</a></td></tr><tr><td><span class="tocsublinknumber">8.2.2<tt>&nbsp;</tt></span><a href="#%28part._.Test_submodules%29" class="tocsubseclink" data-pltdoc="x">Test submodules</a></td></tr><tr><td><span class="tocsublinknumber">8.3<tt>&nbsp;</tt></span><a href="#%28part._.Real-world_issues%29" class="tocsubseclink" data-pltdoc="x">Real-<wbr></wbr>world issues</a></td></tr><tr><td><span class="tocsublinknumber">9<tt>&nbsp;</tt></span><a href="#%28part._v7%29" class="tocsubseclink" data-pltdoc="x">Syntactic abstraction and function definitions</a></td></tr><tr><td><span class="tocsublinknumber">9.1<tt>&nbsp;</tt></span><a href="#%28part._.Improving_performance%29" class="tocsubseclink" data-pltdoc="x">Improving performance</a></td></tr><tr><td><span class="tocsublinknumber">9.2<tt>&nbsp;</tt></span><a href="#%28part._.A_glimpse_into_syntactic_abstraction%29" class="tocsubseclink" data-pltdoc="x">A glimpse into syntactic abstraction</a></td></tr><tr><td><span class="tocsublinknumber">9.3<tt>&nbsp;</tt></span><a href="#%28part._.More_on_.Racket_functions%29" class="tocsubseclink" data-pltdoc="x">More on Racket functions</a></td></tr><tr><td><span class="tocsublinknumber">9.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Keyword_arguments%29" class="tocsubseclink" data-pltdoc="x">Keyword arguments</a></td></tr><tr><td><span class="tocsublinknumber">9.3.2<tt>&nbsp;</tt></span><a href="#%28part._.Optional_arguments%29" class="tocsubseclink" data-pltdoc="x">Optional arguments</a></td></tr><tr><td><span class="tocsublinknumber">10<tt>&nbsp;</tt></span><a href="#%28part._conclusion%29" class="tocsubseclink" data-pltdoc="x">Conclusion</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><h2><a name="(part._.From_.Ht.D.P_to_.Racket)"></a>From HtDP to Racket</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Luis Sanju&#225;n</p></span></div><h3>1<tt>&nbsp;</tt><a name="(part._intro)"></a>Introduction</h3><p>If you have read the book <a href="https://htdp.org"><span style="font-style: italic">How to Design
Programs</span></a> (<span style="font-style: italic"><span style="font-style: italic">HtDP</span></span>) you already know some parts of Racket, the
language on which BSL, ISL, etc. are built. And you may wish to get more
stuff about Racket itself and find out how to translate your <span style="font-style: italic"><span style="font-style: italic">HtDP</span></span>
skills into full Racket.</p><p>You could read the book <a href="https://www.realmofracket.com/">Realm of
Racket</a>, where Racket is introduced as needed in a friendly setting
familiar to <span style="font-style: italic"><span style="font-style: italic">HtDP</span></span> readers. You could even try
<a href="https://docs.racket-lang.org/guide/">The Racket Guide</a>, a gentle
and complete introduction to the language. But you may miss something in
the middle, something not so terse as <span style="font-style: italic">The Guide</span>, written from
(professional) programmers to (professional) programmers, but more
systematic than the <span style="font-style: italic">Realm</span>.</p><p>That&rsquo;s the intent of this project. Its purpose is to show by means of an
example how to start the transition from <span style="font-style: italic"><span style="font-style: italic">HtDP</span></span> languages
(in particular, ISL+) to Racket. At least, what new things to consider when
working directly in Racket.</p><p>An example cannot be complete at all, though. Racket is a very rich
language, and sooner than later you&rsquo;ll need to go deeply into <span style="font-style: italic">The
Guide</span> and <a href="https://docs.racket-lang.org/reference/">The Racket
Reference</a>. So take them as a first step into Racket for whom already
masters <span style="font-style: italic"><span style="font-style: italic">HtDP</span></span>.</p><p>The sample problem we are going to tackle says as follows:</p><blockquote><p>Create a program to obtain bibliographic information about pdf books.
Assume that those pdfs are readable (meaning that they are not made of
photos of pages) and, for simplicity, unencrypted.</p></blockquote><p>This task can be naturally designed as a composition of the following
sub-tasks:</p><ol><li><p>Read the pdf book as text.</p></li><li><p>Search for the ISBN in the resulting text pages.</p></li><li><p>Retrieve from a remote provider information about the book with that
ISBN.</p></li><li><p>Parse the response to represent it as a Racket data type.</p></li></ol><p>For completeness a preliminary solution to tasks 1, 3, and 4 is given
directly in Racket. In this documentation, we will focus on task 2. A
solution to this sub-task is implemented entirely in ISL+.  From this
implementation a Racket version is derived incrementally, presenting
Racket features and constructs step by step in self-contained new versions.</p><p>The sequence of these transformations can be summarized as follows:</p><ul><li><p><span class="stt">"isbn.v0.rkt"</span> (aka. v0) is the ISL+ solution.</p></li><li><p>v1, still is ISL+, introduces the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang</span><span class="hspace"></span></span> shorthand and uses
the <a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/abstraction</span></a> <span style="font-style: italic"><span style="font-style: italic">HtDP</span></span> module to
replace conditionals and some higher-order functions with <span style="font-style: italic">pattern
matching</span> and <span style="font-style: italic">for</span> loops as presented in that module.</p></li><li><p>v2 transitions to Racket. ISL+ functions and constructs are replaced
by Racket functions wherever it is necessary.</p></li><li><p>v3 makes full use of <span style="font-style: italic">pattern matching</span> and <span style="font-style: italic">for</span> loops
along with Racket <span style="font-style: italic">sequences</span>.</p></li><li><p>v4 introduces <span style="font-style: italic">regular expressions</span>.</p></li><li><p>v5, the more substantial transformation, presents <span style="font-style: italic">modules</span>
(yet within a single file), <span style="font-style: italic">contracts</span> and fine-grained
<span style="font-style: italic">require</span>s.</p></li><li><p>v6 splits modules in v5 into separate files. It also introduces unit
testing with <span class="RktSym">rackunit</span> and <span style="font-style: italic">test submodules</span>.</p></li><li><p>v7 talks a bit about performance improvement, introduces
<span style="font-style: italic">keyword arguments</span> and <span style="font-style: italic">optional arguments</span> in functions,
and offers a glimpse into syntactic abstraction.</p></li></ul><p>Each part of this documentation corresponds to each of those
transformations.</p><p>Once you get familiar with Racket, you won&rsquo;t need to go from teaching
languages to Racket, the ultimate goal is that you can think and write in
Racket from the beginning. The only essential advise will remain the same:
stick always to systematic design. What <span style="font-style: italic"><span style="font-style: italic">HtDP</span></span> teaches has
nothing to do with particularities of programming languages, it is all
about solving problems in a systematic way. So don&rsquo;t forget the crucial
point when learning new languages, including Racket.</p><h3>2<tt>&nbsp;</tt><a name="(part._v0)"></a>ISBN extraction in ISL+</h3><p>Consider the problem of extracting the ISBN, if any, from an input string.</p><p>This involves, of course, domain knowledge <span class="refelem"><span class="refcolumn"><span class="refcontent">See
<a href="https://www.isbn-international.org/content/isbn-users-manual">ISBN
User Manual</a> for more information (specifically, Section 5)</span></span></span>. Let&rsquo;s
summarize this knwoledge:</p><p>An <span class="stt">ISBN</span> <span class="refelem"><span class="refcolumn"><span class="refcontent">Words that might point to representations of the
information at hand are formatted in typewriter font.</span></span></span> can be one of two
types (<span class="stt">Format</span>s): <span class="stt">ISBN-10</span> and <span class="stt">ISBN-13</span>. An
<span class="stt">ISBN-String</span> is a <span class="stt">String</span> of thirteen or ten <span class="stt">Digit</span>s (from
<span class="stt">"0"</span> to <span class="stt">"9"</span>), respectively. <span class="stt">ISBN-10-String</span>s accept <span class="stt">"X"</span>
as last digit, too. An <span class="stt">ISBN-10</span> number consists of four groups of
digits. In turn, an <span class="stt">ISBN-13</span> has one more group, a prefix of three
digits, currently: 978 or 979. Groups may appear separated by hyphens or
spaces. So we could see forms like the following:</p><ul><li><p>0262062186</p></li><li><p>0-262-06218-6</p></li><li><p>0 262 06218 6</p></li><li><p>9780201896831</p></li><li><p>978-0-201-89683-1</p></li><li><p>978 0 201 89683 1</p></li><li><p>978-0201896831</p></li></ul><p>Additionally, in printed books such a number is typically preceded by an
identifier that can appear under different guises:</p><ul><li><p>ISBN</p></li><li><p>ISBN:</p></li><li><p>ISBN-10</p></li><li><p>ISBN-13</p></li><li><p>ISBN-10:</p></li><li><p>ISBN-13:</p></li></ul><p>followed by a space before the <span class="stt">ISBN-String</span> itself.</p><p>Finally, a string matching that format is an actual <span class="stt">ISBN</span> if it passes
a validity check, that involves an arithmetic operation<span class="refelem"><span class="refcolumn"><span class="refcontent">See
the
<a href="https://www.isbn-international.org/content/isbn-users-manual">ISBN
User Manual</a> for a description of this operation</span></span></span>.</p><p>The first section of <span class="stt">"isbn.v0.rkt"</span> is, as <span style="font-style: italic">HtDP</span> mandates,
a description of the data types we are going to use to represent the
information at hand.</p><p>All data types should be self-explained, except <span class="stt">ISBN-Word</span>.
<span class="stt">ISBN-Word</span> represents chunks of <span class="stt">ISBN-Letter</span>s, those allowed by the
ISBN specification excluding space separators. It is called <span class="stt">Word</span>
precisely due to such an exclusion.</p><p>While the other data types derive from the domain knowledge, <span class="stt">ISBN-Word</span>
and <span class="stt">ISBN-Letter</span> make sense only with relation to the strategy we are
going to apply to solve the task.</p><p>A natural way of tackling the problem would be based on regular
expressions.  ISBNs could be extracted by matching the given string against
a certain regular expression. Regular expression support is not available
in ISL+, though. We need then a different strategy like the following one:</p><ol><li><p>Split the input string into lines.</p></li><li><p>Split each line into words (strings without spaces inside) and
remove space separators between <span class="stt">ISBN-Word</span>&rsquo;s in each line.</p></li><li><p>Remove hyphens from all resulting strings.</p></li><li><p>Filter those strings that are actual ISBNs.</p></li></ol><p>Step 2 is necessary because an ISBN can contain spaces as separators of
groups.</p><p>Step 3 just normalizes the result of previous steps (by removing hyphens)
to make easier the computation that validates ISBNs in Step 4.</p><p>Step 1, in turn, is justified by the ISBN specification, according to which
the ISBN should appear in its own line. On the other hand, working on lines
should be more efficient than processing possibly very long multi-line
strings.</p><p><span class="RktSym">find-isbn/list</span> realizes this strategy. In turn,
<span class="RktSym">find-isbn</span>, the other main function, produces the first ISBN of a
given format found by <span class="RktSym">find-isbn/list</span>.</p><p>The rest of the code is the result of applying the recipe.</p><p>The implementation uses several string functions that are not directly
provided by ISL+, and we have defined them from scratch in
<span class="stt">"isbn-lib.rkt"</span>.</p><h3>3<tt>&nbsp;</tt><a name="(part._v1)"></a>Preparing for Racket</h3><h4>3.1<tt>&nbsp;</tt><a name="(part._.The_universe_of_languages)"></a>The universe of languages</h4><p>You already know that one of the first things you need to do when working
on DrRacket is to choose the language for your project. Racket is in fact a
myriad of multiple lang-worlds, and you have to live in one of them at each
time.</p><p><span style="font-style: italic">HtDP</span> teaches programming with languages created specifically for
beginners, the so-called teaching languages (BSL, BSL+, ISL, ISL+, and
ASL).  Our ISBN extraction program so far is written in ISL+. And we
specified that language through <span class="ssansserif">Language|Choose Language</span> on
DrRacket.</p><p>There is another, better, way to specify the language at work without the
need of going through the DrRacket menu, the <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> shorthand. It is
better, firstly because it is independent of DrRacket (it can be used on
the editor or IDE you like) and, secondly, because it makes
explicit as part of the code the language in which it is written.
Racket programmers determine the languages of their projects that way, and
we do so with the very first line in <span class="stt">"isbn.v1.rkt"</span>.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><font class="badlink"><span class="RktModLink"><span class="RktSym">htdp/isl+</span></span></font><span class="RktMeta"></span></td></tr></table></blockquote><p><a href="https://htdp.org/2019-02-24/i3-4.html"><span style="font-style: italic">HtDP</span>, Intermezzo 3</a>
introduces two prominent families of Racket constructs to give students the
opportunity to practice them in a friendly manner, <span style="font-style: italic">pattern
matching</span> and <span style="font-style: italic">for loops</span>. These constructs are provided by the
<a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/abstraction</span></a> module.</p><p>Both are intended to produce more readable, typically more concise
code, as well as better performance (in the case of <span class="RktSym">for</span> loops).</p><p>For those reasons, Racket programmers make heavy use of them, and we do so
in <span class="stt">"isbn.v1.rkt"</span>.</p><h5>3.1.1<tt>&nbsp;</tt><a name="(part._.Beginning_pattern_matching)"></a>Beginning pattern matching</h5><p>The transformation from conditionals to the <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> forms provided
by <a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/abstraction</span></a> is straightforward and clearly
explained in the <span style="font-style: italic">HtDP</span> Intermezzo referred above.</p><p>The easiest case appears in the function <span class="RktSym">isbn-format-&gt;predicate?</span>,
where the <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> expression:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29" class="RktValLink" data-pltdoc="x">symbol=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">isbn-13</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-13-string?</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._symbol~3d~3f%29%29" class="RktValLink" data-pltdoc="x">symbol=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">isbn-10</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-10-string?</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>becomes:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">format</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">isbn-13</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-13-string?</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">'</span><span class="RktVal">isbn-10</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-10-string?</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Note how test expressions in <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> clauses are replaced by patterns.</p><p>Similarly, in <span class="RktSym">isbn-string-&gt;numbers</span> test expressions become
patterns, so that</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>translates into</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"X"</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">_</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The only novelty is the wildchar pattern <span class="RktInBG"><span class="hspace"></span><span class="RktIn">_</span><span class="hspace"></span></span>, which translates
<span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span>.</p><p>A more advanced pattern can be seen in <span class="RktSym">isbn-find</span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">_</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Note, though, that in this case, there is no direct correspondence, as
before, between patterns in the <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> clauses and the
<span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> clauses of <span class="RktSym">isbn-find</span> in <span class="stt">"isbn.v0.rkt"</span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbns</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbns</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>That&rsquo;s because the new version of <span class="RktSym">isbn-find</span> is the result of
applying two transformations at once.</p><p>The first implicit transformation replaces <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._filter%29%29" class="RktValLink" data-pltdoc="x">filter</a></span> with
<span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span>, as we will see later. If we wanted to make it explicit we
would have:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-format-&gt;predicate?</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">candidate</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find/list</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>So the <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> expression behind the scene is rather:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>which translates as:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">_</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Here, the pattern <span class="RktPn">(</span><span class="RktSym">p?</span><span class="stt"> </span><span class="RktSym">c</span><span class="RktPn">)</span> matches if <span class="RktPn">(</span><span class="RktSym">p?</span><span class="stt"> </span><span class="RktSym">candidate</span><span class="RktPn">)</span>. Since
<span class="RktSym">p?</span> stands for <span class="RktPn">(</span><span class="RktSym">isbn-format-&gt;predicate?</span><span class="stt"> </span><span class="RktSym">format</span><span class="RktPn">)</span>, it
evaluates to <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#true</span><span class="hspace"></span></span> if <span class="stt">candidate</span> (each of the elements of the
result of the list produced by applying <span class="RktSym">isbn-find/list</span> to the
input string) is of the given format.</p><h4>3.2<tt>&nbsp;</tt><a name="(part._.Beginning_for_loops)"></a>Beginning <span class="RktSym">for</span> loops</h4><p><span class="RktSym">for</span> loops are handy whenever we are going to traverse compound data
and process each of its elements at a time to produce some result.</p><p>Higher-order functions are thus the main target for loop transformations.</p><h5>3.2.1<tt>&nbsp;</tt><a name="(part._for_list_and_for__list)"></a><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span> and <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span></h5><p><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span> iterates over a list to produce another list. The <span class="RktSym">for</span>
form that does the same thing is <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span>.</p><p>In the initial version of <span class="RktSym">isbn-digit-&gt;number</span> we used <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span>
to apply to each letter of a given input string a function that converts it
into a number:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-digit-&gt;number</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>The same is achieved in the next version via <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"X"</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">_</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>As <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span> is syntactically more flexible than <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span>, we
can get rid of the extra local function <span class="RktSym">isbn-digit-&gt;number</span> without
sacrifying readability. In case you prefer to stick to the local function,
which is perfectly sound too, the loop would look like as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">d</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-digit-&gt;number</span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span> can also be used instead of <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span> to implement
<span class="RktSym">isbn-find/list</span>.  In this case two iterations are involved. The
first one consumes the lines of the input string and produces a list of
words per line. Over the list produced by appending all the resulting list
of words, another <span class="RktVar">map</span> is applied to remove hyphens:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span><span class="hspace">&nbsp;</span><span class="RktSym">remove-isbn-hyphens</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">append-map</span><span class="hspace">&nbsp;</span><span class="RktSym">remove-isbn-spaces/list</span><span class="hspace">&nbsp;</span><span class="RktSym">lines</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><span class="RktSym">append-map</span> is not in ISL+, take it thus as pseudocode to convey
the idea of a <span style="font-style: italic">map</span> function that produces here a list of lists
followed by the operation of appending all the resulting sub-lists to get a
flat list.</p><p>This kind of nested iteration whose final result is a list can be
translated into a <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span> loop as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span><span class="RktSym">lines</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-isbn-spaces/list</span><span class="hspace">&nbsp;</span><span class="RktSym">line</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h5>3.2.2<tt>&nbsp;</tt><a name="(part._for_and)"></a><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fand%29%29" class="RktStxLink" data-pltdoc="x">for/and</a></span></h5><p>The <a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/abstraction</span></a> module does also export <span class="RktSym">for</span>
forms whose value is not a list. They are useful whenever the result of
traversing a sequence is synthesized into a single value.</p><p>Thus, the function <span class="RktSym">isbn-word?</span> determines whether a given
<span class="stt">String</span> is an <span class="stt">ISBN-Word</span> by traversing the list of its letters and
checking whether all of them are <span class="stt">ISBN-Letter</span>s. As the final result is
a <span class="stt">Boolean</span> it can be appropriately implemented with <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29" class="RktValLink" data-pltdoc="x">andmap</a></span>:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29" class="RktValLink" data-pltdoc="x">andmap</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-letter?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>The corresponding <span class="RktSym">for</span> loop is <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fand%29%29" class="RktStxLink" data-pltdoc="x">for/and</a></span>:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fand%29%29" class="RktStxLink" data-pltdoc="x">for/and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-letter?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><h5>3.2.3<tt>&nbsp;</tt><a name="(part._for_sum)"></a><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fsum%29%29" class="RktStxLink" data-pltdoc="x">for/sum</a></span></h5><p>When a function traverses a list to produce a number we can use a
<span class="RktVar">fold</span> form. As you already know, the typical example is a function
that takes a list of numbers and produces its sum:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldl%29%29" class="RktValLink" data-pltdoc="x">foldl</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">numbers</span><span class="RktPn">)</span></p></blockquote><p>In <span class="stt">"isbn.v0.rkt"</span> the function <span class="RktSym">isbn-checksumf</span> defines a
local <span class="stt">sum</span> that is computed in that way. In particular, the numbers
given as last argument to <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldl%29%29" class="RktValLink" data-pltdoc="x">foldl</a></span> are the one-by-one multiplication
of two series of numbers of equal length obtained via <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span>:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldl%29%29" class="RktValLink" data-pltdoc="x">foldl</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">multiplicands</span><span class="hspace">&nbsp;</span><span class="RktSym">multipliers</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>There is a <span class="RktSym">for</span> form useful is such cases: <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fsum%29%29" class="RktStxLink" data-pltdoc="x">for/sum</a></span>. In the
didactic example, the <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._foldl%29%29" class="RktValLink" data-pltdoc="x">foldl</a></span> expression would be converted to:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fsum%29%29" class="RktStxLink" data-pltdoc="x">for/sum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktSym">numbers</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></p></blockquote><p>For the <span class="stt">"isbn.v0.rkt"</span> example the transformation could follow
exactly the same structure (using <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span> instead of
<span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span>):</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fsum%29%29" class="RktStxLink" data-pltdoc="x">for/sum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">multiplicands</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">multipliers</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></p></blockquote><p>But it is much better this alternative:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fsum%29%29" class="RktStxLink" data-pltdoc="x">for/sum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">multiplicands</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">multipliers</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>which is not only more concise, but also avoids entirely the intermediate
list, taking advantage of how <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fsum%29%29" class="RktStxLink" data-pltdoc="x">for/sum</a></span> accumulates results along
the way.</p><h5>3.2.4<tt>&nbsp;</tt><a name="(part._.More_on_for_or_and_for_and)"></a>More on <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span> and <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fand%29%29" class="RktStxLink" data-pltdoc="x">for/and</a></span></h5><p>You may have noted that the implementation of <span class="RktSym">isbn-find</span> in
<span class="stt">"isbn.v0.rkt"</span> cannot use <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._ormap%29%29" class="RktValLink" data-pltdoc="x">ormap</a></span>. In particular, the
following version doesn&rsquo;t work in ISL+:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-format-&gt;predicate?</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._ormap%29%29" class="RktValLink" data-pltdoc="x">ormap</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find/list</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Actually, if you are a well-versed <span style="font-style: italic">HtDP</span> reader you know that such
an use violates the signature of ormap:</p><p><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">[List-of</span><span class="hspace">&nbsp;</span><span class="RktCmt">X]</span><span class="hspace">&nbsp;</span><span class="RktCmt">[X</span><span class="hspace">&nbsp;</span><span class="RktCmt">-&gt;</span><span class="hspace">&nbsp;</span><span class="RktCmt">Boolean]</span><span class="hspace">&nbsp;</span><span class="RktCmt">-&gt;</span><span class="hspace">&nbsp;</span><span class="RktCmt">Boolean</span><span class="RktMeta"></span></p><p>On the other hand, the <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span> loop (and, <span style="font-style: italic">mutatis
mutandis</span>, <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fand%29%29" class="RktStxLink" data-pltdoc="x">for/and</a></span>) is less restrictive. It still produces
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">#false</span><span class="hspace"></span></span> if all values in the given sequence evaluate to
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">#false</span><span class="hspace"></span></span>, but the iteration terminates as soon as a
non-<span class="RktInBG"><span class="hspace"></span><span class="RktIn">#false</span><span class="hspace"></span></span> value is encountered, and this value becomes the
result of <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span>.</p><p>Therefore, what follows is a perfectly valid and working use of
<span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-format-&gt;predicate?</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find/list</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Replacing the <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span> expression with a <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> expression leads
to the <span class="stt">"isbn.v1.rkt"</span> version of <span class="RktSym">isbn-find</span>.</p><p>You may be wondering about why <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._ormap%29%29" class="RktValLink" data-pltdoc="x">ormap</a></span> and <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29" class="RktValLink" data-pltdoc="x">andmap</a></span> are not
like those <span class="RktSym">for</span> forms in this respect. In fact, they are, but in
Racket, not in teaching languages. A beginner can better understand
<span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._ormap%29%29" class="RktValLink" data-pltdoc="x">ormap</a></span> and <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._andmap%29%29" class="RktValLink" data-pltdoc="x">andmap</a></span> as they behave in teaching languages.
Nevertheless, <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span> and <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html#%28form._x._%28%28lib._teachpack%2F2htdp%2Fabstraction..rkt%29._for%2Fand%29%29" class="RktStxLink" data-pltdoc="x">for/and</a></span> bring this more
versatile and powerful constructs over the teaching world.</p><h3>4<tt>&nbsp;</tt><a name="(part._v2)"></a>Getting into Racket</h3><h4>4.1<tt>&nbsp;</tt><a name="(part._.The_.Racket_language)"></a>The Racket language</h4><p>It is time to transition from <span style="font-style: italic">HtDP</span> to real Racket. You may guess how to do
that: <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a>.</p><p>The initial decision has to do with the specific language which you are
going to write in: full Racket, the language with all batteries included,
or a basic layer of Racket. Put it in code, <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a>
<a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket</span></a> or <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> <a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a>.</p><p>We choose the latter for two reasons. If we load only the base of Racket we
get what we need with minimal resource demands. The second reason is
pedagogical. With <a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a> we have to import explicitly
everything that is not in the base, and as a consequence we end up learning
which parts of Racket provide the tools we are going to require each
time.</p><h4>4.2<tt>&nbsp;</tt><a name="(part._.Requiring_what_you_need)"></a>Requiring what you need</h4><p>It might come to a surprise to know that functions as fundamental as
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span>, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span>, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span>, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span> are not in
<a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a> but in other module,
<a href="file:///usr/local/racket/doc/reference/pairs.html#%28mod-path._racket%2Flist%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/list</span></a> that you need to require if you are going to
use them.  Similarly, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> is not provided by default, it is
defined in <a href="file:///usr/local/racket/doc/reference/match.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/match</span></a>. You need to require all extra
modules providing those and other not-in-<a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a>
functions:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/file</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">file-&gt;string</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/match</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">match</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/list</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">cons?, empty?, first, range, rest</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/string</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">string-split</span></td></tr></table></blockquote><p>Special mention deserves <span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span>. <span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span> is
not in Racket.  For the moment we keep testing functions with
<span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span> and to do that we need a specialized module:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test-engine/racket-tests</span><span class="RktPn">)</span></p></blockquote><p>To run tests we&rsquo;ll also need to request it with</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._test%29%29" class="RktStxLink" data-pltdoc="x">test</a></span><span class="RktPn">)</span></p></blockquote><p>at the end of the file.</p><h4>4.3<tt>&nbsp;</tt><a name="(part._.Replacing_teaching_functions)"></a>Replacing teaching functions</h4><p>Furthermore, some nice <span style="font-style: italic">HtDP</span> functions are not defined in any Racket module
other than those specifically written with <span style="font-style: italic">HtDP</span> students in mind.
Such is the case of <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span>, <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._implode%29%29" class="RktValLink" data-pltdoc="x">implode</a></span> and
<span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span>.  <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span> (from <a href="file:///usr/local/racket/doc/teachpack/2htdpbatch-io.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/batch-io</span></a>)
is another example.  If we want to live entirely in pure Racket we need to
define them on our own, or to find out Racket substitutes that behave like
them.</p><p><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span> can be replaced by <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-~3elist%29%29" class="RktValLink" data-pltdoc="x">string-&gt;list</a></span>, while,
conversely, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._list-~3estring%29%29" class="RktValLink" data-pltdoc="x">list-&gt;string</a></span> replaces <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._implode%29%29" class="RktValLink" data-pltdoc="x">implode</a></span>. Since
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-~3elist%29%29" class="RktValLink" data-pltdoc="x">string-&gt;list</a></span> produces <span class="stt">[List-of Char]</span> instead of a
<span class="stt">[List-of 1String]</span>, and <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._list-~3estring%29%29" class="RktValLink" data-pltdoc="x">list-&gt;string</a></span> takes <span class="stt">Char</span>s instead
of <span class="stt">1String</span>s, we have to convert the <span class="stt">Char</span> to its corresponding
<span class="stt">String</span>, or to use a <span class="stt">Char</span> in patterns instead of a <span class="stt">String</span>.</p><p><span class="stt">"isbn.v2.rkt"</span> shows several examples of these transformations. For
instance:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"1234567890"</span><span class="RktPn">)</span></p></blockquote><p>becomes</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fmap..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string%29%29" class="RktValLink" data-pltdoc="x">string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-~3elist%29%29" class="RktValLink" data-pltdoc="x">string-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"1234567890"</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>Likewise,</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"X"</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>is transformed to</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">#\X</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string%29%29" class="RktValLink" data-pltdoc="x">string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>As for <span class="RktSym"><a href="file:///usr/local/racket/doc/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span> from <a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/abstraction</span></a> we can use
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/Filesystem.html#%28def._%28%28lib._racket%2Ffile..rkt%29._file-~3estring%29%29" class="RktValLink" data-pltdoc="x">file-&gt;string</a></span> from <a href="file:///usr/local/racket/doc/reference/Filesystem.html#%28mod-path._racket%2Ffile%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/file</span></a> instead.</p><p>And <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span>, what about it? The natural replacement is
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span>.  Unfortunately, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span> is a <span style="font-style: italic">faux-ami</span>.
It works like <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span> if the given element is not a member of a
list:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote><p>evaluates to <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#false</span><span class="hspace"></span></span>, the same value as</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote><p>However, contrary to what you would expect,</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote><p>evaluates to <span class="RktRes">&rsquo;(1 2 3)</span> instead of <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#true</span><span class="hspace"></span></span>.</p><p>In Racket you may stumble upon with these kind of edges, and this one is
related to the same fundamental fact commented in the previous section,
that values other than <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#false</span><span class="hspace"></span></span> are treated as <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#true</span><span class="hspace"></span></span> in
boolean contexts.  Here, instead of <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#true</span><span class="hspace"></span></span>, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span>
produces the tail of the given list from the first element (included) that
is member of that list.</p><p>Therefore, replacing <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span> with <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span> implies
further checking whether the result is a non-empty list. We can use
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._cons~3f%29%29" class="RktValLink" data-pltdoc="x">cons?</a></span> to do that:</p><p>For instance,</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._member~3f%29%29" class="RktValLink" data-pltdoc="x">member?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">digits</span><span class="RktPn">)</span></p></blockquote><p>can be translated as</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._cons~3f%29%29" class="RktValLink" data-pltdoc="x">cons?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">digits</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><h4>4.4<tt>&nbsp;</tt><a name="(part._.Replacing_your_own_functions)"></a>Replacing your own functions</h4><p>Not everything is so laborious. One of the huge benefits of writing in
Racket is that you have access to polished and thoroughly tested
fundamental functions that you may need to define on your own when
teaching languages don&rsquo;t provide them.</p><p>The definitions of <span class="RktSym">split-lines</span> and <span class="RktSym">split-words</span> in
<span class="stt">"isbn.v0.rkt"</span> and <span class="stt">"isbn.v1.rkt"</span> rely upon the
<span class="stt">string-split</span> functionality that we defined ourselves in
<span class="stt">"isbn-lib.rkt"</span>.</p><p>This module can be entirely removed now. The <a href="file:///usr/local/racket/doc/reference/strings.html#%28mod-path._racket%2Fstring%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/string</span></a>
function <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28lib._racket%2Fstring..rkt%29._string-split%29%29" class="RktValLink" data-pltdoc="x">string-split</a></span> gives us the same for free. As an aside,
note that Racket functions are usually more flexible and powerful than the
teaching languages counterparts.  In this case, we take advantage of the
keyword argument <span class="RktPn">#:repeat</span> to craft the functionality we
want.</p><p>In the same vein, we can apply Racket functions in place of our own code.
Thus <span class="RktSym">remove-isbn-hyphens</span> can be easily implemented with
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28lib._racket%2Fstring..rkt%29._string-replace%29%29" class="RktValLink" data-pltdoc="x">string-replace</a></span> from <a href="file:///usr/local/racket/doc/reference/strings.html#%28mod-path._racket%2Fstring%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/string</span></a>. Therefore,</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._implode%29%29" class="RktValLink" data-pltdoc="x">implode</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink" data-pltdoc="x">filter</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/lambda.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktVal">"-"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28def._htdp-intermediate-lambda._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._explode%29%29" class="RktValLink" data-pltdoc="x">explode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>gets simplified to</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28lib._racket%2Fstring..rkt%29._string-replace%29%29" class="RktValLink" data-pltdoc="x">string-replace</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktVal">"-"</span><span class="hspace">&nbsp;</span><span class="RktVal">""</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>Finally, we do no longer require <a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/abstraction</span></a>.
<a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a> provides the same <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> forms (and many
more).</p><h4>4.5<tt>&nbsp;</tt><a name="(part._.Local_definitions)"></a>Local definitions</h4><p>One substantial change you need to carry out when making the transition
from teaching languages to Racket affects local definitions.</p><p>In teaching languages we have the construct <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span>. From now on
<span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span> just drops out. But keep in mind that if something goes
wrong without <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span> you may need to look into <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span> forms.
Actually, teaching languages provide <span class="RktSym"><a href="file:///usr/local/racket/doc/htdp-langs/intermediate-lam.html#%28form._%28%28lib._lang%2Fhtdp-intermediate-lambda..rkt%29._local%29%29" class="RktStxLink" data-pltdoc="x">local</a></span> precisely to avoid
getting overwhelmed with all of those <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span> constructs.</p><h3>5<tt>&nbsp;</tt><a name="(part._v3)"></a>Full pattern matching and <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> loops</h3><h4>5.1<tt>&nbsp;</tt><a name="(part._.More_on_pattern_matching)"></a>More on pattern matching</h4><p><a href="file:///usr/local/racket/doc/teachpack/2htdpabstraction.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/abstraction</span></a> introduces only a minimal part of pattern
matching.  <a href="file:///usr/local/racket/doc/reference/match.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/match</span></a> is vastly more powerful and rich.
It is actually a language in itself.</p><p>As an example, in <span class="stt">"isbn.v3.rkt"</span> <span class="RktSym">adjoin</span> is now defined
with pattern matching. The implementation uses <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._define%2Fmatch%29%29" class="RktStxLink" data-pltdoc="x">define/match</a></span>, that
is a shorthand to <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> a function with <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> clauses
only:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._define%2Fmatch%29%29" class="RktStxLink" data-pltdoc="x">define/match</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">adjoin</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">w</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-word?</span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-word?</span><span class="hspace">&nbsp;</span><span class="RktSym">w1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="hspace">&nbsp;</span><span class="RktSym">w1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Without that shorthand, it should be written as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">adjoin</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%2A%29%29" class="RktStxLink" data-pltdoc="x">match*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">w</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-word?</span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-word?</span><span class="hspace">&nbsp;</span><span class="RktSym">w1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="hspace">&nbsp;</span><span class="RktSym">w1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%2A%29%29" class="RktStxLink" data-pltdoc="x">match*</a></span> allows multiple patterns in clauses. The first clause
matches if <span class="RktSym">lowords</span> is empty. The second one matches if both
<span class="RktSym">word</span> and the first of <span class="RktSym">lowords</span> are <span class="stt">ISBN-Word</span>s. And
the third one, matches everything else.</p><p>The second pattern in the second clause:</p><blockquote class="SCodeFlow"><p><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-word?</span><span class="hspace">&nbsp;</span><span class="RktSym">w1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span><span class="RktPn">]</span></p></blockquote><p>uses two patterns at once:</p><p>First, it matches any list with a first (<span class="RktSym">w1</span>) and a rest (<span class="RktSym">ws</span>):</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">w1</span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span><span class="RktPn">)</span></p></blockquote><p>and, secondly, one whose first is an <span class="stt">ISBN-Word</span>:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-word?</span><span class="hspace">&nbsp;</span><span class="RktSym">w1</span><span class="RktPn">)</span></p></blockquote><h4>5.2<tt>&nbsp;</tt><a name="(part._.More_on_for)"></a>More on <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span></h4><p>You may observe that some higher-order functions involving iteration in
<span class="stt">"isbn.v0.rkt"</span> remain untouched in <span class="stt">"isbn.v2.rkt"</span>. In
particular, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._foldr%29%29" class="RktValLink" data-pltdoc="x">foldr</a></span> in <span class="RktSym">join-isbn-words</span>, and <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink" data-pltdoc="x">filter</a></span>
in <span class="RktSym">isbn-find/list</span>. That&rsquo;s because we need more powerful
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> forms.</p><h5>5.2.1<tt>&nbsp;</tt><a name="(part._for_fold)"></a><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Ffold%29%29" class="RktStxLink" data-pltdoc="x">for/fold</a></span></h5><p>Let&rsquo;s consider <span class="RktSym">join-isbn-words</span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._foldr%29%29" class="RktValLink" data-pltdoc="x">foldr</a></span><span class="hspace">&nbsp;</span><span class="RktSym">adjoin</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>You already know that we could also implement it with <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._foldl%29%29" class="RktValLink" data-pltdoc="x">foldl</a></span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._foldl%29%29" class="RktValLink" data-pltdoc="x">foldl</a></span><span class="hspace">&nbsp;</span><span class="RktSym">adjoin</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>which, in turn, abstracts from a function definition with accumulators
like this:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words-aux</span><span class="hspace">&nbsp;</span><span class="RktSym">acc</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._empty~3f%29%29" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">acc</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words-aux</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">adjoin</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._first%29%29" class="RktValLink" data-pltdoc="x">first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">acc</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words-aux</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">lowords0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>A <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> loop corresponding to the last kind of functions, so one
that keeps track of accumulated values along the traversal and produces a
final value from the accumulator is <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Ffold%29%29" class="RktStxLink" data-pltdoc="x">for/fold</a></span>. With
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Ffold%29%29" class="RktStxLink" data-pltdoc="x">for/fold</a></span> <span class="RktSym">join-isbn-words</span> gets translated as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Ffold%29%29" class="RktStxLink" data-pltdoc="x">for/fold</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">acc</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._reverse%29%29" class="RktValLink" data-pltdoc="x">reverse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">lowords</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">adjoin</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktSym">acc</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h5>5.2.2<tt>&nbsp;</tt><a name="(part._for_guards)"></a><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> guards</h5><p>It is not immediately clear how to convert <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink" data-pltdoc="x">filter</a></span> into a
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> loop.</p><p>For instance,</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink" data-pltdoc="x">filter</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._even~3f%29%29" class="RktValLink" data-pltdoc="x">even?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktPn">)</span></p></blockquote><p>doesn&rsquo;t translate to <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span>:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28quote._~23~25kernel%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._even~3f%29%29" class="RktValLink" data-pltdoc="x">even?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">how to fill dots?</span></p></blockquote><p>Racket <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> forms are equipped with a feature to get what we are
wishing for with clarity and ease: <span style="font-style: italic">guards</span>, boolean expressions
that are introduced by  keywords like <span class="RktPn">#:when</span> or <span class="RktPn">#:unless</span>
attached to <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> clauses.</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">)</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._even~3f%29%29" class="RktValLink" data-pltdoc="x">even?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></p></blockquote><p>Furthermore, the common programming pattern consisting of
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink" data-pltdoc="x">filter</a></span>ing over a <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fmap..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span>:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._filter%29%29" class="RktValLink" data-pltdoc="x">filter</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fmap..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVar">a-collection</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>can be roughly translated into:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVar">a-collection</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>that avoids the intermediate list created by <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fmap..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span>.</p><p>This sort of transformation is applied to the definition of
<span class="RktSym">isbn-find/list</span> in <span class="stt">"isbn.v3.rkt"</span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find/list</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">candidate</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h4>5.3<tt>&nbsp;</tt><a name="(part._.Sequences)"></a>Sequences</h4><p>An entirely new thing that you will encounter over and over in Racket code
is all those <span style="font-style: italic">in</span>-something expressions that appear in
<span class="stt">"isbn.v3.rkt"</span>. They are <span style="font-style: italic">sequence constructors</span>.  Think of
<span style="font-style: italic">sequences</span> as ordered collections of values. There are many
available, and they appear typically within <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> loops. They can
make your code more readable and concise, at least they can and normally do
improve performance.</p><p>What sequence constructor to choose depends on the concrete values
you want to produce and/or of its kind.</p><p>Let&rsquo;s tabulate all of the sequences used in <span class="stt">"isbn.v3.rkt"</span>
along with the values they consume.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">sequence constructor</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span style="font-weight: bold">data type</span></p></td></tr><tr><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p>arbitrary lists</p></td></tr><tr><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-range%29%29" class="RktValLink" data-pltdoc="x">in-range</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p>specific ranges of numbers</p></td></tr><tr><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-cycle%29%29" class="RktValLink" data-pltdoc="x">in-cycle</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p>cyclic series</p></td></tr><tr><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-string%29%29" class="RktValLink" data-pltdoc="x">in-string</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p>strings</p></td></tr><tr><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p>any value</p></td></tr></table></p><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span>, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-range%29%29" class="RktValLink" data-pltdoc="x">in-range</a></span>, and <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-string%29%29" class="RktValLink" data-pltdoc="x">in-string</a></span> are
self-explanatory.</p><p>With <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-cycle%29%29" class="RktValLink" data-pltdoc="x">in-cycle</a></span> we can handle infinite collections of numbers.
Infinite sequences are helpful within <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> loops when we are sure
that the loop will terminate anyway.  Thus the function
<span class="RktSym">isbn-13-valid?</span> passes two sequences as first arguments to the
abstract function <span class="RktSym">isbn-checksumf</span> which, in turn, iterates over
them to compute the checksum for ISBN validation. The <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Fsum%29%29" class="RktStxLink" data-pltdoc="x">for/sum</a></span> loop</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Fsum%29%29" class="RktStxLink" data-pltdoc="x">for/sum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">multiplicands</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">multipliers</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>traverses, in parallel, <span class="RktSym">multiplicands</span> (a sequence constructed via
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span>) and <span class="RktSym">multipliers</span> (an infinite sequence
constructed via <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-cycle%29%29" class="RktValLink" data-pltdoc="x">in-cycle</a></span>). The loop terminates once
<span class="RktSym">multiplicands</span> has been exhausted, so the infinite cyclic sequence
of <span class="RktSym">multipliers</span> doesn&rsquo;t pose any problem.</p><p>There is another somehow &ldquo;weird&rdquo; sequence in <span class="stt">"isbn.v3.rkt"</span>.
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span> is a special sequence of only one element. You may wonder
why we need something like that. The
<a href="https://docs.racket-lang.org/reference/sequences.html?q=in-value#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29">Racket
documentation on the <span class="RktSym"><span class="RktValLink">in-value</span></span> sequence</a> is exact at this respect,
though probably cryptic for casual readers:</p><blockquote><p>This form is mostly useful for let-like bindings in forms such as
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span>.</p></blockquote><p>In order to grasp the usefulness of <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span>, let&rsquo;s consider again
the function <span class="RktSym">isbn-find/list</span>.</p><p>With all of the constructs presented so far we could write this:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find/list</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-lines</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-words</span><span class="hspace">&nbsp;</span><span class="RktSym">line</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Of course, at this level of programming proficiency we shouldn&rsquo;t tolerate
the repeated computation <span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="stt"> </span><span class="RktSym">word</span><span class="RktPn">)</span>.</p><p>The first thing coming to mind is to resort to a local definition like
this:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">candidate</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>There is, though, no feasible way with the tools we currently have to
include such a local definition within the loop. The <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span>
sequence is helpful precisely in that sort of cases. It provides the
behavior we want. The final implementation with <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span> should be
now evident:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find/list</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-lines</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-words</span><span class="hspace">&nbsp;</span><span class="RktSym">line</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">candidate</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h4>5.4<tt>&nbsp;</tt><a name="(part._.A_couple_of_final_tweaks)"></a>A couple of final tweaks</h4><p>The only remaining differences between <span class="stt">"isbn.v2.rkt"</span> and
<span class="stt">"isbn.v3.rkt"</span> are just small touches to keep everything in sync
with the substantial transformations explained in prior sections.</p><p>The first one is the signature of <span class="RktSym">isbn-checksumf</span>. As commented
above the validating functions pass now sequences instead of concrete lists
to this <span class="RktSym">isbn-checksumf</span>. So we coin the <span class="stt">Sequence-of</span> type
to express this fact.</p><p>The second tweak occurs in the definitions of <span class="RktSym">digit?</span> and
<span class="RktSym">isbn-letter?</span>: they use <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._pair~3f%29%29" class="RktValLink" data-pltdoc="x">pair?</a></span> instead of <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._cons~3f%29%29" class="RktValLink" data-pltdoc="x">cons?</a></span> to
check out whether the result of member is not <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#false</span><span class="hspace"></span></span>.
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._cons~3f%29%29" class="RktValLink" data-pltdoc="x">cons?</a></span> is provided by <a href="file:///usr/local/racket/doc/reference/pairs.html#%28mod-path._racket%2Flist%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/list</span></a>, but as we do no
longer need any other list functions, we prefer to use the more primitive
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._pair~3f%29%29" class="RktValLink" data-pltdoc="x">pair?</a></span>  in place of <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._cons~3f%29%29" class="RktValLink" data-pltdoc="x">cons?</a></span> and eliminate the
<a href="file:///usr/local/racket/doc/reference/pairs.html#%28mod-path._racket%2Flist%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/list</span></a> require.  This is, of course, a matter of
taste. Sticking with <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._cons~3f%29%29" class="RktValLink" data-pltdoc="x">cons?</a></span> would be equally valid.</p><h3>6<tt>&nbsp;</tt><a name="(part._v4)"></a>Regular expressions</h3><p>Every general-purpose programming language supports regular expressions.
Racket supports regular expressions too and the mini-language of regular
expressions (<span style="font-style: italic">regexes</span>) is something you need to learn to be
proficient in Racket or in any language. If you know <span style="font-style: italic">regexes</span> from
other languages, you can easily apply what you already know to Racket. If
not, learning <span style="font-style: italic">regexes</span> from Racket would help you use them in other
languages with minor adjustments, since all elaborate upon the same basic
building blocks.</p><p>A <span style="font-style: italic">regular expression</span> (short: <span style="font-style: italic">regex</span>) is a kind of string
describing a pattern which tries to match against another string.</p><p>In fact, the problem of extracting an ISBN from a given string can be
entirely solved with <span style="font-style: italic">regexes</span> only. For instance, the following
expression extracts <span class="stt">ISBN-13</span>s (with its ISBN identifier included) from a
given string, assuming that it is normalized regarding its
spaces:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/regexp.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._regexp-match%2A%29%29" class="RktValLink" data-pltdoc="x">regexp-match*</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">#px"\\d{13}|(?:ISBN(?:-13)?:? )?97[89][ -]\\d{10}|(?:ISBN(?:-13)?:? )?(?=97[89][ -]\\d{1,5}[ -])97[89][ -]\\d{1,5}[ -]\\d{1,7}[ -]\\d{1,6}[ -]\\d"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara">For pedagogical reasons<span class="refelem"><span class="refcolumn"><span class="refcontent">The monstrous one-liner above is against
any style rules. This is intentional. Just to show how cryptic and
overwhelming <span style="font-style: italic">regexes</span> could become.</span></span></span> it seems to be better to go
through this at a slower pace and rely only on more basic <span style="font-style: italic">regexes</span>.
</div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The complete description of the syntax of <span style="font-style: italic">regexes</span> in
Racket can be found in
<a href="https://docs.racket-lang.org/reference/regexp.html">The Racket
Reference, Regular Expressions</a>.</p></blockquote></blockquote></blockquote></div></p><h4>6.1<tt>&nbsp;</tt><a name="(part._.Data_type_definitions_with_regexes)"></a>Data type definitions with <span style="font-style: italic">regexes</span></h4><p>With <span style="font-style: italic">regexes</span> in our toolbox we can simplify and/or specify with
greater precision data type descriptions and definitions.</p><p>An <span class="stt">ISBN-13-String</span> is more precisely defined by its leading digits, 978
or 979:</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">;; An ISBN-13-String is a String consisting of 13 digits, that begins</span></p></td></tr><tr><td><p><span class="stt">;; with "978" or "979"</span></p></td></tr></table></p><p>The corresponding regular expression is as follows:</p><blockquote class="SCodeFlow"><p><span class="RktVal">#px"97[89]\\d{10}"</span></p></blockquote><p>This pattern matches against any string beginning with  <span class="RktInBG"><span class="hspace"></span><span class="RktIn">"978"</span><span class="hspace"></span></span> or
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">"979"</span><span class="hspace"></span></span> followed by 10 digits.</p><p><span class="RktInBG"><span class="hspace"></span><span class="RktIn">#px</span><span class="hspace"></span></span> starts a literal regular expression following a syntax
similar to the Perl regular expression syntax<span class="refelem"><span class="refcolumn"><span class="refcontent">A quick intro
to Perl syntax for <span style="font-style: italic">regexes</span> is available at the
<a href="https://perldoc.perl.org/perlrequick.html">perlrequick doc</a>.</span></span></span>.</p><p>An <span class="stt">ISBN-10-String</span> can also be described by a simple pattern:</p><blockquote class="SCodeFlow"><p><span class="RktVal">#px"\\d{9}[X\\d]"</span></p></blockquote><p>which matches any string consisting of 9 digits followed by <span class="RktInBG"><span class="hspace"></span><span class="RktIn">"X"</span><span class="hspace"></span></span>
or a digit.</p><p>In these definitions the pattern <span class="RktInBG"><span class="hspace"></span><span class="RktIn">"\\d"</span><span class="hspace"></span></span> stands for digit. So the
<span class="stt">Digit</span> data type and the <span class="RktSym">digit?</span> predicate in
<span class="stt">"isbn.v3.rkt"</span> are no longer needed.</p><p>An <span class="stt">ISBN-Word</span>, in turn, can be expressed as:</p><blockquote class="SCodeFlow"><p><span class="RktVal">#px"[\\dX-]+"</span></p></blockquote><p>so a string consisting of one or more (the <span class="RktInBG"><span class="hspace"></span><span class="RktIn">+</span><span class="hspace"></span></span> means that)
occurrences of a digit, <span class="RktInBG"><span class="hspace"></span><span class="RktIn">"X"</span><span class="hspace"></span></span>, or hyphen.</p><p>As before, we no longer need the <span class="stt">ISBN-Letter</span> data nor its
corresponding predicate.</p><p>With <span style="font-style: italic">regexes</span> we can also express more formally what a <span class="stt">Word</span>
is, a string that matches:</p><blockquote class="SCodeFlow"><p><span class="RktVal">#rx"[^ ]+"</span></p></blockquote><p>so a string with one or more letters excluding space (<span class="RktInBG"><span class="hspace"></span><span class="RktIn">[^ ]</span><span class="hspace"></span></span>
matches any character except space).</p><p>By the way, note that the literal <span style="font-style: italic">regex</span> is now introduced by
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">#rx</span><span class="hspace"></span></span> <span class="refelem"><span class="refcolumn"><span class="refcontent"><span class="stt">egrep</span> is a widely known Unix command for
searching for patterns in a string. For more information about its syntax,
see the
<a href="https://www.gnu.org/software/grep/manual/html_node/Regular-Expressions.html#Regular-Expressions">GNU
<span class="stt">grep</span> info page, Regular Expressions</a>.</span></span></span>, which begins a regular
expression that follows an <span class="stt">egrep</span>-like syntax.</p><p>Once defined we can use <span class="stt">Word</span> as data type in the signatures of
several functions.</p><h4>6.2<tt>&nbsp;</tt><a name="(part._regexes_in_predicates)"></a><span style="font-style: italic">regexes</span> in predicates</h4><p>Equipped with <span style="font-style: italic">regexes</span> our remaining data type predicates get
nicely simplified.  In particular, <span class="RktSym">regex-match-exact?</span> allows us to
check whether a value matches exactly the regular expressions at work.</p><p>For example, consider how the long definition of <span class="RktSym">isbn-10-string?</span>
in <span class="stt">"isbn.v3.rkt"</span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-10-string?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">digits+optional-x?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">digits+optional-x?</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init%29%29" class="RktStxLink" data-pltdoc="x">init</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._substring%29%29" class="RktValLink" data-pltdoc="x">substring</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">9</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._last%29%29" class="RktValLink" data-pltdoc="x">last</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._substring%29%29" class="RktValLink" data-pltdoc="x">substring</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktVal">9</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">all-digits?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init%29%29" class="RktStxLink" data-pltdoc="x">init</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">digit?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._last%29%29" class="RktValLink" data-pltdoc="x">last</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._last%29%29" class="RktValLink" data-pltdoc="x">last</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">all-digits?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init%29%29" class="RktStxLink" data-pltdoc="x">init</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fmap..rkt%29._andmap%29%29" class="RktValLink" data-pltdoc="x">andmap</a></span><span class="hspace">&nbsp;</span><span class="RktSym">digit?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fmap..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string%29%29" class="RktValLink" data-pltdoc="x">string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-~3elist%29%29" class="RktValLink" data-pltdoc="x">string-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init%29%29" class="RktStxLink" data-pltdoc="x">init</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">digit?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._pair~3f%29%29" class="RktValLink" data-pltdoc="x">pair?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">digits</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>is transformed into:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-10-string?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/regexp.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._regexp-match-exact~3f%29%29" class="RktValLink" data-pltdoc="x">regexp-match-exact?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-10</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Likewise, <span class="RktSym">isbn-13-string?</span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">all-digits?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">all-digits?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init%29%29" class="RktStxLink" data-pltdoc="x">init</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fmap..rkt%29._andmap%29%29" class="RktValLink" data-pltdoc="x">andmap</a></span><span class="hspace">&nbsp;</span><span class="RktSym">digit?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fmap..rkt%29._map%29%29" class="RktValLink" data-pltdoc="x">map</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string%29%29" class="RktValLink" data-pltdoc="x">string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-~3elist%29%29" class="RktValLink" data-pltdoc="x">string-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init%29%29" class="RktStxLink" data-pltdoc="x">init</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">digit?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._pair~3f%29%29" class="RktValLink" data-pltdoc="x">pair?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">digits</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>becomes a one-liner:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/regexp.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._regexp-match-exact~3f%29%29" class="RktValLink" data-pltdoc="x">regexp-match-exact?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-13</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Finally, <span class="RktSym">isbn-word?</span> which in <span class="stt">"isbn.v3.rkt"</span> was defined as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-word?</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Fand%29%29" class="RktStxLink" data-pltdoc="x">for/and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-string%29%29" class="RktValLink" data-pltdoc="x">in-string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-letter?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string%29%29" class="RktValLink" data-pltdoc="x">string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-letter?</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._pair~3f%29%29" class="RktValLink" data-pltdoc="x">pair?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._member%29%29" class="RktValLink" data-pltdoc="x">member</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-letters</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>is translated into:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-word?</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/regexp.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._regexp-match-exact~3f%29%29" class="RktValLink" data-pltdoc="x">regexp-match-exact?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-word</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h3>7<tt>&nbsp;</tt><a name="(part._v5)"></a>Modules and Contracts</h3><p>Let&rsquo;s recap what we have achieved so far. We have translated our initial
ISL+ version into a Racket version with the aid of two powerful
mini-languages (<span style="font-style: italic">pattern matching</span> and <span style="font-style: italic">regular expressions</span>)
and the whole collection of <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> constructs along with their
accompanying <span style="font-style: italic">sequences</span>.  The result is as readable and
systematically designed as before, but more concise and hopefully more
efficient.</p><p>With the exception of the <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> declaration at the top of the code
everything looks familiar. You may even consider the new material
as a mere extension of ISL+.  Just a matter of absorbing new constructs
and applying them where it makes sense.</p><p>What comes next, though, is a step away from the known landscape into real
Racket, such as it is used by the programmers who write the libraries which
we rely upon.</p><h4>7.1<tt>&nbsp;</tt><a name="(part._.Modules)"></a>Modules</h4><p>Code organization is at the heart of systematic program design. You go from
data definitions (that may need auxiliary data definitions) to
well-organized functions according to the known <span style="font-style: italic">HtDP</span> mantras: one
function per task, top-level design (wished-for function), abstraction,
etc.</p><p>This systematic organization is exercised on the micro-level of a delimited
code body. But when code gets larger and more complex, and remarkably when
some parts of your code might be helpful for several other parts, you may
feel the need of a higher-level organization.  In particular, you may wish
to split your code into separate collections, each around a certain general
purpose. For instance, in our ISBN extraction program we can clearly
distinguish core functions, those that find the ISBN(s) in a string, and
everything else, constants, predicates and functions that help main
functions fulfill their job. Furthermore, you could imagine that the latter
utils may be useful for code that doesn&rsquo;t need to find ISBNs (for instance,
a program to only validate already existing candidates).</p><p>Such high-level organization is achieved in Racket via <span style="font-style: italic">modules</span>.
Modules are code components that collect related definitions and constructs
to be used by other parts of your code, by other modules.</p><p>In fact, in <span style="font-style: italic">HtDP</span> and teaching languages you are working on and
with modules all the time, just that they remain behind the scenes. For
instance, whenever you need tools to build images you require the
definitions contained in the <a href="file:///usr/local/racket/doc/teachpack/2htdpimage.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">2htdp/image</span></a> module. Moreover,
all of your <span style="font-style: italic">HtDP</span> projects are modules themselves collecting the
definitions to solve the problem at hand.</p><p>The next natural step is being able not only to use modules but rather to
create your own modules.</p><p>Although a module typically resides in its own file, you can also
organize code that already exists in a single file. This is a
convenient technique, modularize first your existing code within the
boundaries of a file, and once you are ready, split the resulting modules
into separate files.</p><h5>7.1.1<tt>&nbsp;</tt><a name="(part._.The_module_form)"></a>The <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span> form</h5><p>Modules are primary introduced with the <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span> form, that
specifies the name of the module and the initial imports. So the form:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p></blockquote><p>means that whatever goes in place of the dots belongs to a module that uses
<a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a> definitions (aka. is written in the
<a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a> language), and whose name is <span class="RktSym">utils</span>.</p><p>If you think that this has something to do with the <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a>
declaration of previous versions, you are right. Indeed,</p><p><a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> <a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a></p><p>is just a shorthand for</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span><span class="RktPn">)</span></p></blockquote><p>where <span class="RktVar">name</span> is derived from the filename of the code containing
the <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> shorthand.</p><h5>7.1.2<tt>&nbsp;</tt><a name="(part._.Module_sections)"></a>Module sections</h5><p>In place of the dots in the <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span> form above, you just need to
put all the code you want to be there. For documentation is also
recommended to include a purpose statement about the goal of this code.</p><p>For instance, the module containing utilities to be used in our
ISBN extraction program can be design as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Utils for ISBN extraction</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/match</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-13</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-10</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Any -&gt; Boolean</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is v an ISBN-13-String?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>In this form, though, the module is useless. For one reason, all
definitions inside a module are private by default. In other words,
they can only be used within the module unless we provide them, make
them available to other modules.</p><p>A module exports its definitions via the <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span> form. By
convention the <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span> form constitutes the first section of a
module.  This makes sense because the first thing one will want to know
about a module is what it provides.</p><p>With the provide section the previous example would be written
as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Utils for ISBN extraction ; &lt;- Module Purpose</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&lt;- Provides</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/match</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&lt;- Requires</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-13</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&lt;- Constants</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-10</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Any -&gt; Boolean</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">; &lt;- Function Definitions</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is v an ISBN-13-String?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>Potential users of a module need to know more than just the name of
provided definitions, they should also know their purposes and signatures.
That way the <span style="font-style: italic">interface</span> of a module gets sufficiently specified:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Utils for ISBN extraction ; &lt;- Module Purpose</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> INTERFACE</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt"> &lt;- Provides</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Any -&gt; Boolean</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is v an ISBN-13-String?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">isbn-13-string?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> IMPLEMENTATION</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/match</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&lt;- Requires</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-13</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&lt;- Constants</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-10</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&lt;- Function definitions</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>We can now create a module for the <span class="RktSym">main</span> functions as before:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">ISBN extraction from Strings</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> INTERFACE</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">String ISBN-Format -&gt; [Maybe ISBN]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">extracts the first ISBN ...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">isbn-find</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> IMPLEMENTATION</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/file</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find</span><span class="hspace">&nbsp;</span><span class="RktVal">""</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">isbn-13</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/Writing.html#%28def._%28%28quote._~23~25kernel%29._format%29%29" class="RktValLink" data-pltdoc="x">format</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><h5>7.1.3<tt>&nbsp;</tt><a name="(part._.Requiring_our_own_modules)"></a>Requiring our own modules</h5><p>There is, though, a crucial missing piece in the <span class="RktSym">main</span> module. In
order to use the definitions provided by the <span class="RktSym">utils</span> module the
<span class="RktSym">main</span> module must require <span class="RktSym">utils</span>. Again, this is nothing
new. We have required Racket modules all the time, so we have to require
our own modules when needed. As other requires this essential require
should be placed into the require section:</p><p>The new thing is the syntax for requiring our own modules, that may differ
from the syntax for requiring Racket modules, it&rsquo;ll depend on how those
modules are organized themselves.</p><p>In the current case the syntax is as follows:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._submod%29%29" class="RktStxLink" data-pltdoc="x">submod</a></span><span class="hspace">&nbsp;</span><span class="RktVal">".."</span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>Why this?</p><p>Recall what we have said before about the <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> shorthand. Here we
have a file, which is itself a module (!), with two (sub)modules inside,
and in one of them we refer to the another one.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">name-derived-from-isbn.v5.rkt</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._submod%29%29" class="RktStxLink" data-pltdoc="x">submod</a></span><span class="hspace">&nbsp;</span><span class="RktVal">".."</span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The reference uses a relative location (<span class="RktInBG"><span class="hspace"></span><span class="RktIn">".."</span><span class="hspace"></span></span>), that indicates the
parent module to the current one<span class="refelem"><span class="refcolumn"><span class="refcontent">This is a shorthand borrowed
from the the Unix convention to represent relative file paths, where
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">.</span><span class="hspace"></span></span> means the current directory, and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">..</span><span class="hspace"></span></span>, the parent
directory.</span></span></span>.</p><p>Thus, if we are located in the <span class="RktSym">main</span> module, the current module
path  would be the <span class="RktSym">main</span> module itself, while the parent
(enclosing) module path is the module that corresponds to the file. In
other words, <span class="RktInBG"><span class="hspace"></span><span class="RktIn">".."</span><span class="hspace"></span></span> in the <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._submod%29%29" class="RktStxLink" data-pltdoc="x">submod</a></span> form above points to the
<span class="stt">"isbn.v5.rkt"</span> module, while the <span class="RktVar">utils</span> name points to the
<span class="RktSym">utils</span> module inside that file.</p><p>On the other hand, since the enclosing module uses the <span class="RktSym">main</span> module
(to run tests), we need to require it from within this enclosing module:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktVar">name-derived-from-isbn.v5.rkt</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._submod%29%29" class="RktStxLink" data-pltdoc="x">submod</a></span><span class="hspace">&nbsp;</span><span class="RktVal">".."</span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">main</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>where</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">main</span><span class="RktPn">)</span></p></blockquote><p>says shortly the same as</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._submod%29%29" class="RktStxLink" data-pltdoc="x">submod</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"."</span><span class="hspace">&nbsp;</span><span class="RktSym">main</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><h5>7.1.4<tt>&nbsp;</tt><a name="(part._.What_to_export_)"></a>What to export?</h5><p>In <span class="stt">"isbn.v5.rkt"</span> we haven&rsquo;t exported every function. You can, and
normally you should export only what you consider useful for other possible
modules, and keep private what only belongs to implementation details.</p><p>Here, only predicates related to the representation and a few core utils
have been exported. The rest of functions are actually helpers of
these core utils, and it doesn&rsquo;t make sense to export them.</p><h5>7.1.5<tt>&nbsp;</tt><a name="(part._.Resource-awareness_requires)"></a>Resource-awareness <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span>s</h5><p>You should already observed that <span class="stt">"isbn.v5.rkt"</span> differs form
<span class="stt">"isbn.v4.rkt"</span> in the form of <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span>s.  In the former,
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._only-in%29%29" class="RktStxLink" data-pltdoc="x">only-in</a></span> constructs appear in many <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span> specifications:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._only-in%29%29" class="RktStxLink" data-pltdoc="x">only-in</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/match</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._define%2Fmatch%29%29" class="RktStxLink" data-pltdoc="x">define/match</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._only-in%29%29" class="RktStxLink" data-pltdoc="x">only-in</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/sequence</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fsequence..rkt%29._sequence%2Fc%29%29" class="RktValLink" data-pltdoc="x">sequence/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr></table></blockquote><p>This form allows you to specify exactly what you are going to import from a
module. It is common practice to do so: we import only what we need, and at
the same time we are explicit about our requirements. In our case this also
formalizes what was stated as code comments in prior versions.</p><h4>7.2<tt>&nbsp;</tt><a name="(part._.Contracts)"></a>Contracts</h4><p>The next new and substantial thing introduced in <span class="stt">"isbn.v5.rkt"</span> is
Racket <span style="font-style: italic">contracts</span>.</p><p>There is no better way to express what contracts are than the first
paragraphs in the
<a href="https://docs.racket-lang.org/guide/contract-boundaries.html">Racket
Guide, Contracts, Contracts and Boundaries</a>:</p><blockquote><p>Like a contract between two business partners, a software contract is an
agreement between two parties. The agreement specifies obligations and
guarantees for each &#8220;product&#8221; (or value) that is handed from one party to
the other.</p><p>A contract thus establishes a boundary between the two parties. Whenever a
value crosses this boundary, the contract monitoring system performs
contract checks, making sure the partners abide by the established
contract.</p><p>In this spirit, Racket encourages contracts mainly at module boundaries.
Specifically, programmers may attach contracts to provide clauses and thus
impose constraints and promises on the use of exported values.</p></blockquote><p>Coming from <span style="font-style: italic">HtDP</span>, you can surely recognize that contracts allows us to
formalize data types and function signatures, which in <span style="font-style: italic">HtDP</span> are only
comments for the programmer that, nonetheless, she should follow. With
contracts we formulate the same obligations (and promises) but with the
advantage of an actual checking mechanism about them. Now if something
violates our contracts the system (not only the teacher) will complain.</p><p>The good news is that Racket contracts are as expressive and flexible
as signatures. The not so good news is that that comes at a price of
being a complex subject in itself that may be intimidating the first
time we encounter it.</p><h5>7.2.1<tt>&nbsp;</tt><a name="(part._.Data_types_and_contracts)"></a>Data types and contracts</h5><p>Let&rsquo;s list how our data types, as used in our function signatures,
can be converted into contracts.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Signatures</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span style="font-weight: bold">Contracts</span></p></td></tr><tr><td><p><span class="RktInBG"><span class="hspace"></span><span class="RktIn">#f</span><span class="hspace"></span></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktInBG"><span class="hspace"></span><span class="RktIn">#f</span><span class="hspace"></span></span></p></td></tr><tr><td><p><span class="stt">Boolean</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></td></tr><tr><td><p><span class="stt">String</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span></p></td></tr><tr><td><p><span class="stt">N</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._natural-number%2Fc%29%29" class="RktValLink" data-pltdoc="x">natural-number/c</a></span></p></td></tr></table></p><p>The <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#f</span><span class="hspace"></span></span> value can be used as a contract that recognizes itself.
Also, Racket core predicates like <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span> or <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span> can
be used as contracts.  <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._natural-number%2Fc%29%29" class="RktValLink" data-pltdoc="x">natural-number/c</a></span> is a contract defined by
the contract system to recognize natural numbers, including 0. It is more
common in contracts than <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/generic-numbers.html#%28def._%28%28lib._racket%2Fmath..rkt%29._natural~3f%29%29" class="RktValLink" data-pltdoc="x">natural?</a></span> because the latter is not
provided by <a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a>.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Signatures</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span style="font-weight: bold">Contracts</span></p></td></tr><tr><td><p><span class="stt">ISBN</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn?</span></p></td></tr><tr><td><p><span class="stt">ISBN-10-String</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-10-string?</span></p></td></tr><tr><td><p><span class="stt">ISBN-13-String</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-13-string?</span></p></td></tr><tr><td><p><span class="stt">ISBN-Format</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-format?</span></p></td></tr><tr><td><p><span class="stt">Word</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">word?</span></p></td></tr></table></p><p>This transformation is really easy: our own predicates double as contracts,
too.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Signatures</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span style="font-weight: bold">Contracts</span></p></td></tr><tr><td><p><span class="stt">[List-of ...]</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p></td></tr><tr><td><p><span class="stt">or</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p></td></tr><tr><td><p><span class="stt">[Maybe ...]</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">#f</span><span class="RktPn">)</span></p></td></tr></table></p><p>This table lists <span style="font-style: italic">contract combinators</span> corresponding to commonly
used signature &ldquo;combinators&rdquo;. A contract combinator is just a function
that takes contracts and produce other contracts.</p><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span> is the contract combinator corresponding to the
<span class="stt">List-of</span> signature.  For instance <span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span>
corresponds to <span class="stt">[List-of Boolean]</span>.</p><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span> translates itemizations in signatures. For instance,
<span class="stt">String</span> or <span class="stt">Symbol</span> becomes <span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span><span class="RktPn">)</span>.</p><p>One particular form of <span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span>, namely, <span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktVal">#f</span><span class="RktPn">)</span>,
translates our <span class="stt">Maybe</span> data types. For instance, <span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktSym">isbn?</span><span class="stt"> </span><span class="RktVal">#f</span><span class="RktPn">)</span> corresponds to <span class="stt">[Maybe ISBN]</span>.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Signatures</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span style="font-weight: bold">Contracts</span></p></td></tr><tr><td><p><span class="stt">Any</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></p></td></tr><tr><td><p><span class="stt">Sequence-of</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fsequence..rkt%29._sequence%2Fc%29%29" class="RktValLink" data-pltdoc="x">sequence/c</a></span></p></td></tr></table></p><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span> is a contract that recognizes any kind of value, it
corresponds to the <span class="stt">Any</span> data type in signatures, hardly used in <span style="font-style: italic">HtDP</span>.</p><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fsequence..rkt%29._sequence%2Fc%29%29" class="RktValLink" data-pltdoc="x">sequence/c</a></span> (from <a href="file:///usr/local/racket/doc/reference/sequences.html#%28mod-path._racket%2Fsequence%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/sequence</span></a>), is a
contract combinator for sequences.</p><h5>7.2.2<tt>&nbsp;</tt><a name="(part._.Function_contracts)"></a>Function contracts</h5><p>Contracts for functions are specified with the contract combinator
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span>. So,</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p></blockquote><p>is the contract for a function, where dots are filled with the contracts
for the values consumed followed by the contract for the value produced.</p><p>For instance:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></p></blockquote><p>is the contract for a function that takes a <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span> and produces a
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span>.</p><p>By the way, a function whose contract is:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></p></blockquote><p>is so common that there exists a contract shorthand:</p><blockquote class="SCodeFlow"><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._predicate%2Fc%29%29" class="RktValLink" data-pltdoc="x">predicate/c</a></span></p></blockquote><h5>7.2.3<tt>&nbsp;</tt><a name="(part._.From_signatures_to_contracts)"></a>From signatures to contracts</h5><p>The constructs presented in the preceding sections are what we need to
know in oder to translate all the signatures in <span class="stt">"isbn.v4.rkt"</span> into
contracts<span class="refelem"><span class="refcolumn"><span class="refcontent">We specify contracts for all functions, not only
for the exported functions, just for practising. In the final version,
signatures remain instead of contracts when functions are private.</span></span></span>.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-find</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">String? ISBN-Format -&gt; [Maybe ISBN]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktSym">isbn-format?</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktSym">isbn?</span><span class="stt"> </span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-format-&gt;predicate?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ISBN-Format -&gt; [Any -&gt; Boolean]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym">isbn-format?</span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._predicate%2Fc%29%29" class="RktValLink" data-pltdoc="x">predicate/c</a></span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-13-string?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">Any -&gt; Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._predicate%2Fc%29%29" class="RktValLink" data-pltdoc="x">predicate/c</a></span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-10-string?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">Any -&gt; Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._predicate%2Fc%29%29" class="RktValLink" data-pltdoc="x">predicate/c</a></span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-find/list</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">String -&gt; [List-of ISBN]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym">isbn?</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">join-isbn-words</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">[List-of Word] -&gt; [List-of Word]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym">word?</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym">word?</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">adjoin</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">Word [List-of Word] -&gt; [List-of Word]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym">word?</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym">word?</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym">word?</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-word?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">Word -&gt; Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym">word?</span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">Any -&gt; Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._predicate%2Fc%29%29" class="RktValLink" data-pltdoc="x">predicate/c</a></span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-13?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">Any -&gt; Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._predicate%2Fc%29%29" class="RktValLink" data-pltdoc="x">predicate/c</a></span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-13-valid?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ISBN-13-String Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym">isbn-13-string?</span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-checksumf</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">[Sequence-of N] [Sequence-of N] N -&gt; Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fsequence..rkt%29._sequence%2Fc%29%29" class="RktValLink" data-pltdoc="x">sequence/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._natural-number%2Fc%29%29" class="RktValLink" data-pltdoc="x">natural-number/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fsequence..rkt%29._sequence%2Fc%29%29" class="RktValLink" data-pltdoc="x">sequence/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._natural-number%2Fc%29%29" class="RktValLink" data-pltdoc="x">natural-number/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._natural-number%2Fc%29%29" class="RktValLink" data-pltdoc="x">natural-number/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-string-&gt;numbers</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ISBN-String -&gt; [List-of N]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym">isbn-string?</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._natural-number%2Fc%29%29" class="RktValLink" data-pltdoc="x">natural-number/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-10?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">Any -&gt; Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._predicate%2Fc%29%29" class="RktValLink" data-pltdoc="x">predicate/c</a></span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">isbn-10-valid?</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ISBN-10-String -&gt; Boolean</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym">isbn-10-string?</span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">remove-isbn-hyphens</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">String -&gt; String</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">remove-isbn-spaces/list</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">String -&gt; [List-of Word]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym">word?</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">split-lines</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">String -&gt; [List-of String]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Function:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym">split-words</span></p></td></tr><tr><td><p><span style="font-weight: bold">Signature:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">String -&gt; [List-of String]</span></p></td></tr><tr><td><p><span style="font-weight: bold">Contract:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="stt"> </span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktSym">word?</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr></table></p><p>As an aside, a close inspection shows that <span class="stt">"isbn.v5.rkt"</span>
introduces two new predicates that are not in <span class="stt">"isbn.v4.rkt"</span>,
<span class="RktSym">isbn-format?</span> and <span class="RktSym">isbn-string?</span>. The reason is that they
are used as contracts.</p><p>Once we have transformed function signatures into contracts, we can replace
the signatures of our functions with those contracts.  To do so we need a
bit more of syntax.</p><p>First, to associate definitions with their respective contracts we must use
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/attaching-contracts-to-values.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._contract-out%29%29" class="RktStxLink" data-pltdoc="x">contract-out</a></span>, that goes inside the <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span> form enclosing
all the exported definitions.</p><p>Second, to use contracts in the provide section we have to import contract
support (not included in <a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a>) before the
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span> form:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/contract</span><span class="RktPn">)</span></p></blockquote><p>With these final additions a module like <span class="RktSym">utils</span> would show this
shape:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">utils</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Utils for ISBN extraction</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/contract</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/attaching-contracts-to-values.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._contract-out%29%29" class="RktStxLink" data-pltdoc="x">contract-out</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is v an ISBN-13-String?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._predicate%2Fc%29%29" class="RktValLink" data-pltdoc="x">predicate/c</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/match</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-13</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-10</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-13-string?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><h5>7.2.4<tt>&nbsp;</tt><a name="(part._.Aside__what_about_data_type_definitions_)"></a>Aside: what about data type definitions?</h5><p>You may be wondering about what happened to data definitions in prior
versions. Why have they been removed from <span class="stt">"isbn.v5.rkt"</span>.</p><p>Well, there are two reasons for that, apart from the fact that those
data type descriptions have been already given in preceding versions.</p><p>First, predicates and contracts should be enough documentation most of the
time. Second, even if they aren&rsquo;t, the module documentation should fill the
gaps by describing how the information at work has been represented. The
doc for <span class="stt">"isbn.v*.rkt"</span> sources is precisely this manual.</p><p>In Racket source code as it appears in production you won&rsquo;t probably find
the kind of data type specifications we are familiar with in <span style="font-style: italic">HtDP</span>
projects. <span class="stt">"isbn.v5.rkt"</span> is in this sense like other Racket
libraries: code should be enough by itself, and when not, just read the
doc.</p><h3>8<tt>&nbsp;</tt><a name="(part._v6)"></a>More on modules and <a href="file:///usr/local/racket/doc/rackunit/api.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">rackunit</span></a></h3><h4>8.1<tt>&nbsp;</tt><a name="(part._.From_submodules_to_modules)"></a>From submodules to modules</h4><p><span class="stt">"isbn.v5.rkt"</span> gave high-level organization to our code by means of
modules within the same file, actually submodules.</p><p>It was a preliminary step. It is usually better to keep modules in
separate files.</p><p>We create now two files, <span class="stt">"isbn-utils.rkt"</span> and
<span class="stt">"isbn.v6.rkt"</span> to hold each of the submodules in
<span class="stt">"isbn.v5.rkt"</span>.</p><p>This transformation implies some small changes. Let&rsquo;s outline them.</p><p>Modules in a single file:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">--</span><span class="hspace">&nbsp;</span><span class="RktCmt">isbn.v5.rkt</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta">racket/base</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">utils</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">racket/base</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">main</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">racket/base</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._submod%29%29" class="RktStxLink" data-pltdoc="x">submod</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">".."</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">utils</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/quote.html#%28form._%28%28quote._~23~25kernel%29._quote%29%29" class="RktStxLink" data-pltdoc="x">'</a></span><span class="RktSym">main</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote><p>Modules in their own files:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">--</span><span class="hspace">&nbsp;</span><span class="RktCmt">isbn-utils.rkt</span><span class="hspace">&nbsp;</span><span class="RktCmt">(prev.</span><span class="hspace">&nbsp;</span><span class="RktCmt">utils</span><span class="hspace">&nbsp;</span><span class="RktCmt">submodule)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta">racket/base</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktMeta"></span></td></tr></table></blockquote><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">--</span><span class="hspace">&nbsp;</span><span class="RktCmt">isbn.v6.rkt</span><span class="hspace">&nbsp;</span><span class="RktCmt">(prev.</span><span class="hspace">&nbsp;</span><span class="RktCmt">main</span><span class="hspace">&nbsp;</span><span class="RktCmt">submodule)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta">racket/base</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"isbn-utils.rkt"</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktMeta"></span></td></tr></table></blockquote><p>First, initial imports (second argument of <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28quote._~23~25kernel%29._module%29%29" class="RktStxLink" data-pltdoc="x">module</a></span> forms) become
the language names for <a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> shorthands.</p><p>Second, the module path in the <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span> of the <span class="RktSym">utils</span>
module takes the name of the file holding that module, as a string.</p><h4>8.2<tt>&nbsp;</tt><a name="(part._.Rackunit_and_testing_submodules)"></a>Rackunit and testing submodules</h4><h5>8.2.1<tt>&nbsp;</tt><a name="(part._.Unit_testing_with_rackunit)"></a>Unit testing with rackunit</h5><p>Like in <span style="font-style: italic">HtDP</span>, we have been testing functions with
<span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span> from <a href="file:///usr/local/racket/doc/test-engine/index.html#%28mod-path._test-engine%2Fracket-tests%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">test-engine/racket-tests</span></a>. This
is perfectly fine, but most Racket programmers use <a href="file:///usr/local/racket/doc/rackunit/api.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">rackunit</span></a>
for unit testing, and we are going to do so, too.</p><p>We no longer need <a href="file:///usr/local/racket/doc/test-engine/index.html#%28mod-path._test-engine%2Fracket-tests%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">test-engine/racket-tests</span></a>. Instead, we
require <a href="file:///usr/local/racket/doc/rackunit/api.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">rackunit</span></a>:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rackunit</span><span class="RktPn">)</span></p></blockquote><p>The following table shows <a href="file:///usr/local/racket/doc/rackunit/api.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">rackunit</span></a> replacements to
<span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span>s used so far:</p><p><table cellspacing="0" cellpadding="0" style="border-collapse: collapse;"><tr><td style="border-bottom: 1px solid black;"><p><a href="file:///usr/local/racket/doc/test-engine/index.html#%28mod-path._test-engine%2Fracket-tests%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">test-engine/racket-tests</span></a></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><p><a href="file:///usr/local/racket/doc/rackunit/api.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">rackunit</span></a></p></td></tr><tr><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">#t</span><span class="RktPn">)</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-true%29%29" class="RktValLink" data-pltdoc="x">check-true</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">#f</span><span class="RktPn">)</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-false%29%29" class="RktValLink" data-pltdoc="x">check-false</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/test-engine/index.html#%28form._%28%28lib._test-engine%2Fracket-tests..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVar">a-value</span><span class="RktPn">)</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVar">a-value</span><span class="RktPn">)</span></p></td></tr></table></p><h5>8.2.2<tt>&nbsp;</tt><a name="(part._.Test_submodules)"></a>Test submodules</h5><p>Unlike <a href="file:///usr/local/racket/doc/test-engine/index.html#%28mod-path._test-engine%2Fracket-tests%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">test-engine/racket-tests</span></a>, <a href="file:///usr/local/racket/doc/rackunit/api.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">rackunit</span></a>
tests must come after the function definitions they are testing. In
practical terms this would mean to place all tests at the end of the file,
or into a separate file.</p><p>However, one of the hallmarks of <span style="font-style: italic">HtDP</span> is that test cases appear
before each function definition, instilling the right testing-first mindset
in students. It would indeed come at a loss being forced by a framework to
abandon it, consequently, many Racket programmers do stick to interleaving
tests by means of submodules. Let&rsquo;s see how they do that.</p><p>The <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span> form allows us to declare a submodule with a given
name:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>which can access to the definitions in the enclosing module. For instance,
in</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="file:///usr/local/racket/doc/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><a href="file:///usr/local/racket/doc/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/base</span></a><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">test1</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rackunit</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote><p>the submodule named <span class="RktSym">test1</span> can access directly to the definition of
<span class="RktVal">"foo"</span> in the enclosing module even though it is not provided, and we
don&rsquo;t need to require the submodule in order to be executed.</p><p>You may guess that we can now put tests before functions in this way:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rackunit</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test2</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rackunit</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bar</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bar</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Not exactly! There is a better way that completely avoids redundancy: with
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span>  the same submodule can be decomposed into different
pieces that will be later combined for us. So what we actually do is this:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rackunit</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">foo</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bar</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bar</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The first form declares the module named <span class="RktSym">test</span> and requires
<a href="file:///usr/local/racket/doc/rackunit/api.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">rackunit</span></a>. Subsequent forms pointing to the same
<span class="RktSym">test</span> module just add on it.</p><h4>8.3<tt>&nbsp;</tt><a name="(part._.Real-world_issues)"></a>Real-world issues</h4><p>The real-world is often messy and wild. This is an a striking example:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/rackunit/api.html#%28def._%28%28lib._rackunit%2Fmain..rkt%29._check-equal~3f%29%29" class="RktValLink" data-pltdoc="x">check-equal?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find</span><span class="hspace">&nbsp;</span><span class="RktVal">"0&#8212;262&#8212;06218&#8212;6"</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">"0262062186"</span><span class="RktPn">)</span></p></blockquote><p>We absolutely expect that the above test passes, but it fails because,
shockingly:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">remove-isbn-hyphens</span><span class="hspace">&nbsp;</span><span class="RktVal">"0&#8212;262&#8212;06218&#8212;6"</span><span class="RktPn">)</span></p></blockquote><p>doesn&rsquo;t remove hyphens!</p><p>A closer inspection would show that the Unicode code point for the hyphen
in that string is <span class="RktInBG"><span class="hspace"></span><span class="RktIn">U+2014</span><span class="hspace"></span></span>, while the code point for the ASCII
hyphen is <span class="RktInBG"><span class="hspace"></span><span class="RktIn">U+002d</span><span class="hspace"></span></span>. In other words, what appears to be an ASCII
hyphen is actually a Unicode dash.</p><p>This example is not so contrived as it seems to be. It comes
actually from converting to text a book published by a well-regarded
academic publisher, and many of its ebooks use the same dash for
representing ISBN hyphens.</p><p>The morale is that real-world facts could break our code and thus reveal
unjustified assumptions. In this case, we wrongly assumed that an ISBN
hyphen could only be an ASCII hyphen.</p><p>Fortunately, we can fix this easily in Racket. Racket regular expressions
allow for matching against Unicode categories, one of which is the
<span style="font-style: italic">punctuation-dash category</span> (<span class="RktInBG"><span class="hspace"></span><span class="RktIn">Pd</span><span class="hspace"></span></span>), which includes many sort
of dashes.  Among them are a few like wavy dashes that shouldn&rsquo;t be
representations of ISBN hyphen. We could be as specific as we want and
exclude weird dashes. For simplicity we include them all under the
assumption that the probability of ISBN candidates with those weirdos is
practically null.</p><p>The pattern to match the punctuation-dash category is <span class="RktInBG"><span class="hspace"></span><span class="RktIn">"\\p{Pd}"</span><span class="hspace"></span></span>,
and a regular expression for this pattern can be build with:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/regexp.html#%28def._%28%28quote._~23~25kernel%29._pregexp%29%29" class="RktValLink" data-pltdoc="x">pregexp</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"\\p{Pd}"</span><span class="RktPn">)</span></p></blockquote><p>which is equivalent to the literal regular expression:</p><blockquote class="SCodeFlow"><p><span class="RktVal">#px"\\p{Pd}"</span></p></blockquote><p>Corresponding constants are:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-dash</span><span class="hspace">&nbsp;</span><span class="RktVal">"\\p{Pd}"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-dash</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/regexp.html#%28def._%28%28quote._~23~25kernel%29._pregexp%29%29" class="RktValLink" data-pltdoc="x">pregexp</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-dash</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Removing hyphens can still be implemented with <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28lib._racket%2Fstring..rkt%29._string-replace%29%29" class="RktValLink" data-pltdoc="x">string-replace</a></span>,
since this function can take regular expressions as second argument:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28lib._racket%2Fstring..rkt%29._string-replace%29%29" class="RktValLink" data-pltdoc="x">string-replace</a></span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-dash</span><span class="hspace">&nbsp;</span><span class="RktVal">""</span><span class="RktPn">)</span></p></blockquote><p>On the other hand, since ISBN hyphens are allowed letters in ISBN words
we also need to re-implement <span class="RktSym">isbn-word?</span> as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/regexp.html#%28def._%28%28quote._~23~25kernel%29._pregexp%29%29" class="RktValLink" data-pltdoc="x">pregexp</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"("</span><span class="hspace">&nbsp;</span><span class="RktVal">"[\\dX]"</span><span class="hspace">&nbsp;</span><span class="RktVal">"|"</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-dash</span><span class="hspace">&nbsp;</span><span class="RktVal">")+"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/regexp.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._regexp-match-exact~3f%29%29" class="RktValLink" data-pltdoc="x">regexp-match-exact?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">re-isbn-word</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span></td></tr></table></blockquote><p>where <span class="RktSym">re-isbn-word</span>, expressed as a literal, would look like this:</p><blockquote class="SCodeFlow"><p><span class="RktVal">#px"([\\dX]|\\p{Pd})+"</span></p></blockquote><p>meaning: <span style="font-style: italic">one or more occurrences of digit, or "X", or Unicode
dash</span>.</p><h3>9<tt>&nbsp;</tt><a name="(part._v7)"></a>Syntactic abstraction and function definitions</h3><h4>9.1<tt>&nbsp;</tt><a name="(part._.Improving_performance)"></a>Improving performance</h4><p>In real-word applications, the <span class="RktSym">isbn-find</span> function will have to
consume much longer strings than the examples proposed as test cases.</p><p>This means that the current implementation of <span class="RktSym">isbn-find</span>, which
always calls <span class="RktSym">isbn-find/list</span>, will take more time than what the
context of its application may need.</p><p>On the other hand, most potential applications of <span class="RktSym">isbn-find</span> might
require only the first ISBN found, whatever its format.</p><p>All of this calls for a simpler and more efficient <span class="RktSym">isbn-find</span>. Such
an implementation, that now takes a single argument, could be based on
<span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2For%29%29" class="RktStxLink" data-pltdoc="x">for/or</a></span> combined with a <span class="RktPn">#:when</span> guard, taking
advantage of the fact that the loop will terminate as soon as the guard is
satisfied:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2For%29%29" class="RktStxLink" data-pltdoc="x">for*/or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-lines</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-words</span><span class="hspace">&nbsp;</span><span class="RktSym">line</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">candidate</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-normalize</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h4>9.2<tt>&nbsp;</tt><a name="(part._.A_glimpse_into_syntactic_abstraction)"></a>A glimpse into syntactic abstraction</h4><p>Do you note the similarity between this new <span class="RktSym">isbn-find</span> definition
and the definition of <span class="RktSym">isbn-find/list</span>?</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find/list</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-lines</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-words</span><span class="hspace">&nbsp;</span><span class="RktSym">line</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">candidate</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-normalize</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Everything is identical save for the <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> forms, <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2For%29%29" class="RktStxLink" data-pltdoc="x">for*/or</a></span>
and <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span>, respectively.</p><p>Of course, this should remind you
<a href="https://htdp.org/2019-02-24/part_three.html"><span style="font-style: italic">HtDP</span>, Part
III</a>, and it should encourage you to try this abstraction:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find-abs</span><span class="hspace">&nbsp;</span><span class="RktSym">iter</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">iter</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-lines</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-words</span><span class="hspace">&nbsp;</span><span class="RktSym">line</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">candidate</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-normalize</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find-abs</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2For%29%29" class="RktStxLink" data-pltdoc="x">for*/or</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find/list</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find-abs</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2A%2Flist%29%29" class="RktStxLink" data-pltdoc="x">for*/list</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Unfortunately, this doesn&rsquo;t work because those <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%29%29" class="RktStxLink" data-pltdoc="x">for</a></span> forms are not
functions and cannot be passed like you pass functions to other functions.</p><p>There is still hope, though, and more than a hope, a whole underlying
universe that sustains everything in Racket. Given the scope of this
project we can just point to it and leave you exploring the new magic on
your own.</p><p>The abstraction you are wishing for is this one:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define-syntax%29%29" class="RktStxLink" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-find-abs</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Parsing_Syntax.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._syntax-parse%29%29" class="RktStxLink" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktSym">iter</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">iter</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-lines</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">join-isbn-words</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">split-words</span><span class="hspace">&nbsp;</span><span class="RktSym">line</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">candidate</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-value%29%29" class="RktValLink" data-pltdoc="x">in-value</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn-normalize</span><span class="hspace">&nbsp;</span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">candidate</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>And to use it you also need this require:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for-syntax%29%29" class="RktStxLink" data-pltdoc="x">for-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">syntax/parse</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><h4>9.3<tt>&nbsp;</tt><a name="(part._.More_on_.Racket_functions)"></a>More on Racket functions</h4><p>Changing the purpose and implementation of a function doesn&rsquo;t mean
eliminating the former behavior. So we retain the functionality of finding
the first ISBN of a given format. We change the name appropriately to
<span class="RktSym">find-isbn/format</span>. And we take the opportunity to make the
function more flexible by means of new Racket constructs.</p><h5>9.3.1<tt>&nbsp;</tt><a name="(part._.Keyword_arguments)"></a>Keyword arguments</h5><p>A Racket function can be defined with <span style="font-style: italic">keyword arguments</span>.
This enhances readability when functions take multiple arguments. In the
new version of <span class="RktSym">isbn-find/format</span> the second argument is named with
the keyword <span class="RktPn">#:format</span>:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">find-isbn/format</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:format</span><span class="hspace">&nbsp;</span><span class="RktSym">format</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p></blockquote><p>Callers of this function must include that keyword. For instance:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">find-isbn/format</span><span class="hspace">&nbsp;</span><span class="RktVal">"123"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:format</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">isbn-13</span><span class="RktPn">)</span></p></blockquote><p>A contract for this function must also include the keyword:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:format</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-format?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p>The benefit of keywords shows up when the function takes several
arguments, some or all of which are keyworded. For instance,</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">person-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktPn">#:age</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktPn">#:gender</span><span class="hspace">&nbsp;</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktPn">#:name</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p></blockquote><p>can be called with any order of arguments:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">person-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktPn">#:gender</span><span class="hspace">&nbsp;</span><span class="RktVal">"female"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:age</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">#:name</span><span class="hspace">&nbsp;</span><span class="RktVal">"Amy"</span><span class="RktPn">)</span></p></blockquote><p>is as valid as</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">person-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktPn">#:name</span><span class="hspace">&nbsp;</span><span class="RktVal">"Amy"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:age</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktPn">#:gender</span><span class="hspace">&nbsp;</span><span class="RktVal">"female"</span><span class="RktPn">)</span></p></blockquote><h5>9.3.2<tt>&nbsp;</tt><a name="(part._.Optional_arguments)"></a>Optional arguments</h5><p>Sometimes we don&rsquo;t want users waste time specifying things that have
a sane default value, but we still want to give them the option of
doing so. For this purpose, function definitions in Racket, as in many
other programming languages, support <span style="font-style: italic">optional arguments</span>.</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">find-isbn/format</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/syntax/Library_Syntax_Classes_and_Literal_Sets.html#%28form._%28%28lib._syntax%2Fparse..rkt%29._str%29%29" class="RktStxLink" data-pltdoc="x">str</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:format</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">format</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">isbn-13</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p></blockquote><p>The above definition declares the keyword argument <span class="RktVar">format</span> as
optional with <span class="RktVal">'</span><span class="RktVal">isbn-13</span> as default value.</p><p>Callers can rely on defaults:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">find-isbn/format</span><span class="hspace">&nbsp;</span><span class="RktVal">"123"</span><span class="RktPn">)</span></p></blockquote><p>or provide its own value as usual:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">find-isbn/format</span><span class="hspace">&nbsp;</span><span class="RktVal">"123"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:format</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">isbn-10</span><span class="RktPn">)</span></p></blockquote><p>The corresponding contract is special, too. It uses <span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%2A%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span>*</a></span> as
contract combinator, followed by the group of contracts for non-optional
arguments (surrounded by parentheses), the group of contracts for optional
arguments (surrounded by parentheses, too), and the contract for the
result:</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%2A%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span>*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">#:format</span><span class="hspace">&nbsp;</span><span class="RktSym">isbn-format?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/local/racket/doc/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">isbn?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><h3>10<tt>&nbsp;</tt><a name="(part._conclusion)"></a>Conclusion</h3><p>It has been a long trip from <span style="font-style: italic">HtDP</span> to here. But not as hard as one
might have expected. Each stretch was beautiful in its own way. Each
shows the beauty of logic. Nothing happens without a reason, mutations
follow each other systematically and predictably. Of course, practical
goals were the main thrust, but beauty was always on the horizon.</p><p>Writing code is like writing a novel, or, even, a poem. Poets are fond of
languages, and inventors of languages. Every poem spawns its own language.
Every program builds its own story with multiple pieces from a mother
tongue to create, like poetry, its particular language.</p><p>Logic and beauty are ultimately related like poetry and programming.
Hopefully, this humble project help you build your own beautiful programs.</p></div></div><div id="contextindicator">&nbsp;</div></body></html>